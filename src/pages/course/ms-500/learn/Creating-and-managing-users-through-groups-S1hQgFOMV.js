import * as React from "react"
import Page from '../../../../components/page'
import Container from 'react-bootstrap/Container'
import Row from 'react-bootstrap/Row'
import Col from 'react-bootstrap/Col'
import Accordion from 'react-bootstrap/Accordion'
import ListGroup from 'react-bootstrap/ListGroup'
import Form from 'react-bootstrap/Form'
import { Link } from "gatsby"
import {getDoc, getAllDocs, saveDoc, onAuthStateChanged} from '../../../../components/firebase'
import draftToHtml from 'draftjs-to-html'
import { IoChevronBack, IoChevronForward } from "react-icons/io5";
 
const isBrowser = () => typeof window !== 'undefined'

const removePaddingStyle = {
  padding: '0px'
}

const marginTop24Style = {
  marginTop: '24px'
}

const listItemStyle = {
  border: 'none',
  paddingTop: '12px',
  paddingBottom: '12px'
}

const sort = (course, articles) => {
  return articles.sort((a, b) => {
    return course.contentOrder.indexOf(a.id) - course.contentOrder.indexOf(b.id)
  })
}

class ArticlePage extends React.Component {
  constructor(props) {
    super(props)
    this.trackScrolling = this.trackScrolling.bind(this)
    this.setHasCompletedContent = this.setHasCompletedContent.bind(this)

    let currentSlug = props.location.pathname.replace('/course/ms-500/learn/', '').split('/')[0]
    if (currentSlug === 'article')
      currentSlug = 'Securing-and-implementing-enterprise-applications-2QfoI2HxY'

    this.state = {
      currentSlug: currentSlug,
      isTrackScrolling: false,
      course: {"title":"Training for MS-500: Microsoft Office 365 Security Admin","id":"MS-500","contentOrder":["cpchjBLkC","KKkBOVuS4","bzotoOjEe","cg_vxOX9L","uYCIPbnMC","7CpqFkPZU","rZzausKJ1","ky5W0Lz5P","i9pJIjTNH","S1hQgFOMV","2QfoI2HxY","V1en9Iugh","nAAIvNbtk","2S9jn0aLr","FldNualGC","NFQ6rYFeQ","rK48f6iM2","RHW1API2s","z8EMM9Eu_","Kye_yNLxA","EnPyp7ukN","6HUOr7qbL","GCOOUsSBT","GG4cMY8pK","z0qPG6v4T","LEyZMWBSt","7MQ3wE4wP","sH_Ee1DW1","vLweLmxZf","NsF7No40f","IsPGsme8w","wv2PbXnhI","7gR3L122b","ZyKX3Idjs","MAjW0a2_p","XFXu2zIS9","_LL9VqGZO","qDRA4jjoN","62t_7oiZx"],"description":"Learn, prepare and training for the Microsoft Microsoft Office 365 Exam MS-500: Microsoft 365 Security Administration MS-500 exam","sections":[{"title":"Introduction","id":"qwJW5VrBW","order":0},{"order":1,"title":"Securing identity and access to Microsoft 365","id":"AFV_acckJ"},{"order":2,"title":"Securing Microsoft 365, clouds, and on-premises environments","id":"QScYfSu74"},{"title":"Protecting your environment from accidental and malicious data loss","order":3,"id":"YhftdGIRX"},{"order":4,"id":"l0DxUuonW","title":"Protecting User devices using Intune"}],"audience":"Anyone who wants to learn about securing Microsoft 365"},
      article: {"images":["https://i.ibb.co/ySVxbWK/new-microsoft-365-group.png","https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png","https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png","https://i.ibb.co/104HV6d/create-a-distribution-group.png","https://i.ibb.co/104HV6d/create-a-distribution-group.png","https://i.ibb.co/bbX5gBD/create-a-security-group.png","https://i.ibb.co/zQJ9x1M/name-your-new-group.png","https://i.ibb.co/zQJ9x1M/name-your-new-group.png","https://i.ibb.co/nLrY8x6/new-group-email-address.png","https://i.ibb.co/xM6DN61/create-distribution-group.png","https://i.ibb.co/TTf23Bz/create-security-group.png","https://i.ibb.co/4frD0dC/manage-distribution-group.png","https://i.ibb.co/YhY7R2R/manage-members-of-distribution-group.png","https://i.ibb.co/5n13V6V/add-members-to-group.png","https://i.ibb.co/FmHL7tG/add-members-to-the-group.png","https://i.ibb.co/wR07Y6n/create-group-in-outlook.png","https://i.ibb.co/TkpzRv9/add-members-to-outlook-group.png","https://i.ibb.co/xMzW2hd/azure-ad-groups.png","https://i.ibb.co/LzXYCTW/azure-ad-new-group.png","https://i.ibb.co/Kq64m2j/New-dynamic-group.png","https://i.ibb.co/JBzmGBQ/dyanmic-membership-rules.png","https://i.ibb.co/3RtXhW7/access-review-settings.png","https://i.ibb.co/3RtXhW7/access-review-settings.png","https://i.ibb.co/DMZz1sY/Access-review-reviews2.png","https://i.ibb.co/ggzVL3L/access-review-review-type2.png","https://i.ibb.co/vP17HPH/Azure-AD-Identity-Governance.png","https://i.ibb.co/bXKkwKH/new-access-review.png","https://i.ibb.co/ZSKQgj7/naming-policy-navigation.png","https://i.ibb.co/FD4vJbd/configure-group-naming-policy.png","https://i.ibb.co/cxPHf87/set-group-expiration.png"],"featuredImage":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png","article":{"entityMap":{"0":{"data":{"targetOption":"_blank","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard"},"type":"LINK","mutability":"MUTABLE"},"1":{"data":{"width":"auto","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups","src":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png","height":"auto","alt":"Add a group to Microsoft 365","alignment":"none","targetOption":"_blank"},"type":"IMAGE","mutability":"MUTABLE"},"2":{"type":"IMAGE","mutability":"MUTABLE","data":{"alt":"create a distribution group","targetOption":"_blank","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups","height":"auto","src":"https://i.ibb.co/104HV6d/create-a-distribution-group.png","alignment":"none","width":"auto"}},"3":{"mutability":"MUTABLE","data":{"alt":"Name your new Microsoft 365 group","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups","width":"auto","alignment":"none","src":"https://i.ibb.co/zQJ9x1M/name-your-new-group.png","height":"auto","targetOption":"_blank"},"type":"IMAGE"},"4":{"data":{"width":"auto","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups","alt":"New group email address","targetOption":"_blank","alignment":"none","src":"https://i.ibb.co/nLrY8x6/new-group-email-address.png","height":"auto"},"mutability":"MUTABLE","type":"IMAGE"},"5":{"mutability":"MUTABLE","data":{"targetOption":"_blank","alignment":"none","width":"auto","height":"auto","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups","src":"https://i.ibb.co/xM6DN61/create-distribution-group.png","alt":"create distribution group"},"type":"IMAGE"},"6":{"type":"LINK","data":{"alt":"Add a group to Microsoft 365","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups","src":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png","targetOption":"_blank","height":"auto","width":"auto","alignment":"left"},"mutability":"MUTABLE"},"7":{"data":{"width":"auto","targetOption":"_blank","alt":"manage distribution group","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard","alignment":"none","height":"auto","src":"https://i.ibb.co/4frD0dC/manage-distribution-group.png"},"type":"IMAGE","mutability":"MUTABLE"},"8":{"type":"IMAGE","mutability":"MUTABLE","data":{"src":"https://i.ibb.co/YhY7R2R/manage-members-of-distribution-group.png","alt":"manage members of distribution group","targetOption":"_blank","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard","alignment":"none","width":"auto","height":"auto"}},"9":{"data":{"alignment":"none","alt":"add members to group","src":"https://i.ibb.co/5n13V6V/add-members-to-group.png","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard","width":"auto","targetOption":"_blank","height":"auto"},"mutability":"MUTABLE","type":"IMAGE"},"10":{"mutability":"MUTABLE","data":{"src":"https://i.ibb.co/FmHL7tG/add-members-to-the-group.png","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard","width":"auto","targetOption":"_blank","height":"auto","alt":"Add members to the group","alignment":"none"},"type":"IMAGE"},"11":{"type":"LINK","mutability":"MUTABLE","data":{"width":"auto","src":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png","targetOption":"_blank","alignment":"left","alt":"Add a group to Microsoft 365","height":"auto","url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard"}},"12":{"data":{"width":"auto","url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","alignment":"none","height":"auto","alt":"Add a group to Microsoft 365","targetOption":"_blank","src":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png"},"type":"IMAGE","mutability":"MUTABLE"},"13":{"data":{"url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","width":"auto","alignment":"none","alt":"Create a security group","targetOption":"_blank","src":"https://i.ibb.co/bbX5gBD/create-a-security-group.png","height":"auto"},"type":"IMAGE","mutability":"MUTABLE"},"14":{"mutability":"MUTABLE","data":{"height":"auto","alignment":"none","width":"auto","src":"https://i.ibb.co/zQJ9x1M/name-your-new-group.png","targetOption":"_blank","url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","alt":"Name your new Microsoft 365 group"},"type":"IMAGE"},"15":{"data":{"url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","targetOption":"_blank","height":"auto","src":"https://i.ibb.co/TTf23Bz/create-security-group.png","width":"auto","alt":"Create security group","alignment":"none"},"type":"IMAGE","mutability":"MUTABLE"},"16":{"mutability":"MUTABLE","data":{"src":"https://i.ibb.co/ySVxbWK/new-microsoft-365-group.png","targetOption":"_blank","alt":"Create a new Microsoft 365 group in Outlook","width":"auto","height":"auto","alignment":"none","url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93"},"type":"IMAGE"},"17":{"type":"IMAGE","data":{"targetOption":"_blank","width":"auto","alignment":"none","alt":"Create Microsoft 365 group in Outlook","height":"auto","url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","src":"https://i.ibb.co/wR07Y6n/create-group-in-outlook.png"},"mutability":"MUTABLE"},"18":{"type":"IMAGE","data":{"alt":"Add members to outlook group","src":"https://i.ibb.co/TkpzRv9/add-members-to-outlook-group.png","height":"auto","targetOption":"_blank","width":"auto","url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","alignment":"none"},"mutability":"MUTABLE"},"19":{"type":"LINK","data":{"url":"https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93","targetOption":"_blank"},"mutability":"MUTABLE"},"20":{"type":"LINK","data":{"targetOption":"_blank","url":"https://support.office.com/en-us/article/create-a-group-in-outlook-04d0c9cf-6864-423c-a380-4fa858f27102"},"mutability":"MUTABLE"},"21":{"data":{"targetOption":"_blank","url":"https://support.office.com/en-us/article/create-a-team-site-in-sharepoint-online-ef10c1e7-15f3-42a3-98aa-b5972711777d"},"type":"LINK","mutability":"MUTABLE"},"22":{"type":"LINK","data":{"url":"https://docs.microsoft.com/en-us/dynamics365/customer-engagement/admin/deploy-office-365-groups","targetOption":"_blank"},"mutability":"MUTABLE"},"23":{"data":{"url":"https://docs.microsoft.com/en-us/microsoftteams/office-365-groups","targetOption":"_blank"},"type":"LINK","mutability":"MUTABLE"},"24":{"data":{"url":"https://support.office.com/en-us/article/create-a-group-in-yammer-b407af4f-9a58-4b12-b43e-afbb1b07c889","targetOption":"_blank"},"mutability":"MUTABLE","type":"LINK"},"25":{"type":"IMAGE","mutability":"MUTABLE","data":{"src":"https://i.ibb.co/xMzW2hd/azure-ad-groups.png","height":"auto","width":"auto","alignment":"none","alt":"Azure AD Groups"}},"26":{"data":{"alt":"Azure AD New Group","src":"https://i.ibb.co/LzXYCTW/azure-ad-new-group.png","alignment":"none","height":"auto","width":"auto"},"type":"IMAGE","mutability":"MUTABLE"},"27":{"data":{"src":"https://i.ibb.co/Kq64m2j/New-dynamic-group.png","alt":"Create a new dynamic group","alignment":"none","width":"auto","height":"auto"},"type":"IMAGE","mutability":"MUTABLE"},"28":{"type":"IMAGE","mutability":"MUTABLE","data":{"height":"auto","src":"https://i.ibb.co/JBzmGBQ/dyanmic-membership-rules.png","width":"auto","alignment":"none","alt":"Dynamic membership rules"}},"29":{"data":{"alignment":"none","src":"https://i.ibb.co/vP17HPH/Azure-AD-Identity-Governance.png","width":"auto","alt":"Azure AD Identity Governance","height":"auto"},"type":"IMAGE","mutability":"MUTABLE"},"30":{"type":"IMAGE","mutability":"MUTABLE","data":{"alignment":"none","width":"auto","src":"https://i.ibb.co/bXKkwKH/new-access-review.png","alt":"new access review","height":"auto"}},"31":{"mutability":"MUTABLE","data":{"alt":"Create new access review Review Type page","alignment":"none","height":"auto","src":"https://i.ibb.co/ggzVL3L/access-review-review-type2.png","width":"auto"},"type":"IMAGE"},"32":{"type":"IMAGE","data":{"width":"auto","alt":"New access review reviews page","alignment":"none","height":"auto","src":"https://i.ibb.co/DMZz1sY/Access-review-reviews2.png"},"mutability":"MUTABLE"},"33":{"type":"IMAGE","mutability":"MUTABLE","data":{"alignment":"none","width":"auto","height":"auto","alt":"Set the access review settings","src":"https://i.ibb.co/3RtXhW7/access-review-settings.png"}},"34":{"data":{"src":"https://i.ibb.co/ZSKQgj7/naming-policy-navigation.png","alt":"Azure AD Groups Navigation","alignment":"none","height":"auto","width":"auto"},"type":"IMAGE","mutability":"MUTABLE"},"35":{"type":"IMAGE","data":{"alignment":"none","src":"https://i.ibb.co/FD4vJbd/configure-group-naming-policy.png","width":"auto","height":"auto","alt":"Configure group naming policy"},"mutability":"MUTABLE"},"36":{"type":"LINK","data":{"targetOption":"_blank","url":"https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/GroupsManagementMenuBlade/Lifecycle"},"mutability":"MUTABLE"},"37":{"type":"IMAGE","mutability":"MUTABLE","data":{"height":"auto","width":"auto","alt":"set group expiration","alignment":"none","src":"https://i.ibb.co/cxPHf87/set-group-expiration.png"}}},"blocks":[{"depth":0,"inlineStyleRanges":[],"text":"re are four types of groups in Microsoft 365: distribution, security groups, mail-enabled security, and Microsoft 365. Let’s dive right into the types of groups.","entityRanges":[],"type":"unstyled","data":{},"key":"c5n98"},{"data":{},"depth":0,"text":"Distribution groups","entityRanges":[],"type":"header-two","key":"aumor","inlineStyleRanges":[]},{"key":"1kejj","data":{},"inlineStyleRanges":[],"text":"Distribution groups also known as distribution lists will create an email address and distribute the emails to all the members of the group. Distribution groups do not have separate mailboxes. The emails land in the members of the distribution lists mailboxes. You can add anyone with a mailbox inside your organization and you can add mail contacts to distribution groups.","type":"unstyled","depth":0,"entityRanges":[]},{"type":"header-three","entityRanges":[],"key":"58njk","inlineStyleRanges":[],"depth":0,"data":{},"text":"Create a distribution group in Microsoft 365"},{"depth":0,"data":{},"text":"1. Go to the Microsoft 365 admin center > Teams & groups > Active teams & groups. Then click Add a group.","inlineStyleRanges":[{"length":26,"offset":13,"style":"BOLD"},{"style":"BOLD","length":14,"offset":42},{"offset":59,"style":"BOLD","length":21},{"style":"BOLD","length":11,"offset":93}],"type":"unstyled","key":"f6298","entityRanges":[{"length":11,"key":0,"offset":93}]},{"key":"51c8t","data":{},"inlineStyleRanges":[],"text":" ","type":"atomic","depth":0,"entityRanges":[{"key":1,"offset":0,"length":1}]},{"data":{},"key":"esc8l","inlineStyleRanges":[{"offset":9,"style":"BOLD","length":13},{"style":"BOLD","offset":24,"length":4}],"type":"unstyled","entityRanges":[],"text":"2. Click Distribution > Next.","depth":0},{"data":{},"key":"d6iis","depth":0,"type":"atomic","inlineStyleRanges":[],"entityRanges":[{"offset":0,"length":1,"key":2}],"text":" "},{"entityRanges":[],"text":"3. Name the group. Optionally add a description. Click Next.","type":"unstyled","inlineStyleRanges":[{"style":"BOLD","offset":55,"length":4}],"key":"b10d5","data":{},"depth":0},{"data":{},"type":"atomic","text":" ","entityRanges":[{"offset":0,"length":1,"key":3}],"depth":0,"inlineStyleRanges":[],"key":"5i5d5"},{"key":"rvlu","entityRanges":[],"depth":0,"data":{},"text":"4. Set the group email address. Optionally click Allow people outside of my organization to send email to this Distribution group. Click Next.","type":"unstyled","inlineStyleRanges":[{"offset":49,"style":"BOLD","length":80},{"offset":137,"style":"BOLD","length":4}]},{"entityRanges":[{"length":1,"key":4,"offset":0}],"inlineStyleRanges":[],"data":{},"type":"atomic","key":"34ttb","depth":0,"text":" "},{"text":"5. Click Create group.","data":{},"depth":0,"entityRanges":[],"inlineStyleRanges":[{"style":"BOLD","length":12,"offset":9}],"type":"unstyled","key":"aolgn"},{"key":"do4ob","data":{},"depth":0,"type":"atomic","inlineStyleRanges":[],"entityRanges":[{"offset":0,"length":1,"key":5}],"text":" "},{"entityRanges":[],"depth":0,"inlineStyleRanges":[],"type":"header-three","key":"d6k6a","data":{},"text":"Add members to the distribution group"},{"data":{},"inlineStyleRanges":[],"key":"bif90","text":"You’ll notice you can’t add members to the group while creating the group. To add members, you’ll need to go to the group and manage the members.","type":"unstyled","depth":0,"entityRanges":[]},{"key":"8es99","data":{},"entityRanges":[{"length":21,"offset":59,"key":6}],"type":"unstyled","text":"1. Go to the Microsoft 365 admin center > Teams & groups > Active teams & groups > Distribution List.  Then click the group you want to manage.","depth":0,"inlineStyleRanges":[{"style":"BOLD","offset":13,"length":26},{"offset":42,"length":14,"style":"BOLD"},{"style":"BOLD","length":21,"offset":59},{"offset":83,"length":17,"style":"BOLD"}]},{"inlineStyleRanges":[],"type":"atomic","key":"47djl","depth":0,"data":{},"entityRanges":[{"key":7,"length":1,"offset":0}],"text":" "},{"key":"cipo0","data":{},"type":"unstyled","depth":0,"inlineStyleRanges":[{"style":"BOLD","offset":9,"length":7},{"style":"BOLD","offset":19,"length":27}],"text":"2. Click Members > View all and manage members.","entityRanges":[]},{"depth":0,"data":{},"type":"atomic","key":"3h8ih","entityRanges":[{"key":8,"length":1,"offset":0}],"inlineStyleRanges":[],"text":" "},{"text":"3. Click Add members.","key":"4eb4q","inlineStyleRanges":[{"length":11,"style":"BOLD","offset":9}],"entityRanges":[],"type":"unstyled","depth":0,"data":{}},{"type":"atomic","inlineStyleRanges":[],"key":"8p6sk","text":" ","entityRanges":[{"key":9,"offset":0,"length":1}],"depth":0,"data":{}},{"text":"4. Select the users you want to add to the group. Then click Add.","type":"unstyled","key":"9mcv2","depth":0,"entityRanges":[],"inlineStyleRanges":[{"style":"BOLD","offset":61,"length":3}],"data":{}},{"inlineStyleRanges":[],"data":{},"text":" ","key":"ab8uo","depth":0,"type":"atomic","entityRanges":[{"length":1,"offset":0,"key":10}]},{"depth":0,"entityRanges":[],"type":"header-two","inlineStyleRanges":[],"key":"9ljfq","data":{},"text":"Security groups"},{"type":"unstyled","inlineStyleRanges":[],"depth":0,"key":"e02bs","text":"Microsoft 365 security groups, formerly known as Office 365 security groups, allow admins to manage access to resources, for example, SharePoint, Intune, or apply conditional access policies.","entityRanges":[],"data":{}},{"inlineStyleRanges":[],"type":"header-three","text":"Create a security group in Microsoft 365","data":{},"key":"81rrj","depth":0,"entityRanges":[]},{"key":"415kk","depth":0,"entityRanges":[{"length":11,"key":11,"offset":93}],"inlineStyleRanges":[{"style":"BOLD","length":26,"offset":13},{"style":"BOLD","offset":42,"length":14},{"offset":59,"length":21,"style":"BOLD"},{"length":11,"offset":93,"style":"BOLD"}],"text":"1. Go to the Microsoft 365 admin center > Teams & groups > Active teams & groups. Then click Add a group","type":"unstyled","data":{}},{"entityRanges":[{"key":12,"offset":0,"length":1}],"depth":0,"data":{},"text":" ","type":"atomic","key":"14bdm","inlineStyleRanges":[]},{"depth":0,"text":"2. Click Security > Next.","inlineStyleRanges":[{"length":8,"style":"BOLD","offset":9},{"offset":20,"style":"BOLD","length":4}],"entityRanges":[],"data":{},"key":"4shsn","type":"unstyled"},{"key":"503dp","entityRanges":[{"key":13,"length":1,"offset":0}],"data":{},"text":" ","inlineStyleRanges":[],"depth":0,"type":"atomic"},{"data":{},"text":"3. Name the group. Optionally add a description. Click Next.","entityRanges":[],"key":"dipgs","depth":0,"inlineStyleRanges":[{"length":4,"style":"BOLD","offset":55}],"type":"unstyled"},{"entityRanges":[{"length":1,"offset":0,"key":14}],"type":"atomic","key":"607r2","data":{},"inlineStyleRanges":[],"depth":0,"text":" "},{"key":"20v1u","depth":0,"type":"unstyled","text":"4. Click Create group.","entityRanges":[],"data":{},"inlineStyleRanges":[{"offset":9,"length":12,"style":"BOLD"}]},{"entityRanges":[{"length":1,"offset":0,"key":15}],"depth":0,"inlineStyleRanges":[],"type":"atomic","text":" ","key":"ecge4","data":{}},{"inlineStyleRanges":[],"text":"Add members to the security group","key":"27a05","data":{},"entityRanges":[],"depth":0,"type":"header-three"},{"type":"unstyled","inlineStyleRanges":[],"key":"954ck","data":{},"depth":0,"entityRanges":[],"text":"To add members, you’ll need to go to the group and manage the members."},{"inlineStyleRanges":[{"length":26,"offset":13,"style":"BOLD"},{"length":14,"style":"BOLD","offset":42},{"offset":59,"style":"BOLD","length":21},{"length":8,"style":"BOLD","offset":83}],"type":"unstyled","entityRanges":[],"depth":0,"data":{},"key":"2aele","text":"1. Go to the Microsoft 365 admin center > Teams & groups > Active teams & groups > Security. Then click the group you want to manage"},{"depth":0,"data":{},"type":"unstyled","key":"9cd2t","inlineStyleRanges":[{"length":7,"offset":9,"style":"BOLD"},{"style":"BOLD","offset":19,"length":27}],"text":"2. Click Members > View all and manage members.","entityRanges":[]},{"text":"3. Click Add members.","entityRanges":[],"depth":0,"data":{},"type":"unstyled","key":"4mfbu","inlineStyleRanges":[{"style":"BOLD","offset":9,"length":11}]},{"type":"unstyled","depth":0,"inlineStyleRanges":[{"length":3,"offset":61,"style":"BOLD"}],"text":"4. Select the users you want to add to the group. Then click Add.","entityRanges":[],"data":{},"key":"2o8s2"},{"text":"Mail-enabled security groups","key":"1vmfm","depth":0,"type":"header-two","inlineStyleRanges":[],"data":{},"entityRanges":[]},{"depth":0,"data":{},"key":"3pesb","text":"Mail-enabled security groups are the best of both worlds. Use mail-enabled security groups to distribute messages and grant access permissions to resources in Microsoft 365.","entityRanges":[],"type":"unstyled","inlineStyleRanges":[]},{"data":{},"entityRanges":[],"text":"You create mail-enabled security groups the same way you create security/distribution groups.","key":"elqtj","depth":0,"inlineStyleRanges":[],"type":"unstyled"},{"depth":0,"inlineStyleRanges":[],"key":"8n14s","data":{},"entityRanges":[],"type":"header-two","text":"Microsoft 365 groups"},{"type":"unstyled","text":"Microsoft 365 groups allow users to create and manage their own teams. Microsoft 365 groups can create Microsoft Teams, shared mailboxes, or open discussion forums in Yammer. They can also be used in SharePoint sites, Planner, OneDrive shared libraries, Power BI and more. Note, I said can because depending on where you create the team it will change what is created along with it.","key":"90n3u","entityRanges":[],"depth":0,"inlineStyleRanges":[],"data":{}},{"type":"header-three","data":{},"entityRanges":[],"inlineStyleRanges":[],"depth":0,"key":"15cag","text":"How to create a Microsoft 365 group with a shared mailbox"},{"data":{},"key":"ftvnh","inlineStyleRanges":[],"depth":0,"entityRanges":[],"text":"1. Open Outlook.","type":"unstyled"},{"depth":0,"text":"2. Right-click Groups in the left pane and click New Group.","type":"unstyled","entityRanges":[],"data":{},"key":"5se0k","inlineStyleRanges":[]},{"key":"3pt88","type":"atomic","data":{},"text":" ","inlineStyleRanges":[],"depth":0,"entityRanges":[{"offset":0,"key":16,"length":1}]},{"type":"unstyled","data":{},"inlineStyleRanges":[{"style":"BOLD","length":6,"offset":130}],"depth":0,"text":"3. Set the name, email address, description, privacy, and decide if you want the emails to go to everyone’s mailboxes. Then click Create.","entityRanges":[],"key":"e0ob"},{"key":"a6i7d","data":{},"text":" ","inlineStyleRanges":[],"entityRanges":[{"offset":0,"key":17,"length":1}],"depth":0,"type":"atomic"},{"type":"unstyled","key":"2njm8","depth":0,"entityRanges":[],"inlineStyleRanges":[{"offset":71,"style":"BOLD","length":11}],"data":{},"text":"4. Enter the other members' names. Click the member to add them. Click Add Members."},{"entityRanges":[{"offset":0,"length":1,"key":18}],"data":{},"inlineStyleRanges":[],"key":"h1d2","text":" ","depth":0,"type":"atomic"},{"entityRanges":[],"inlineStyleRanges":[],"depth":0,"key":"5nhvc","data":{},"type":"header-three","text":"How to create a Microsoft 365 group in other apps"},{"key":"1fffi","depth":0,"data":{},"type":"unstyled","text":"Since knowing all the ways to create a Microsoft 365 group is outside the scope of MS-500 I’ll simply link the instructions below:","entityRanges":[],"inlineStyleRanges":[]},{"entityRanges":[{"key":19,"length":34,"offset":0}],"data":{},"type":"unordered-list-item","inlineStyleRanges":[],"key":"2p9g7","depth":0,"text":"Create a plan in Microsoft Planner"},{"depth":0,"data":{},"inlineStyleRanges":[],"key":"cqmft","text":"Create a group in Microsoft Outlook","entityRanges":[{"length":35,"offset":0,"key":20}],"type":"unordered-list-item"},{"entityRanges":[{"offset":0,"length":32,"key":21}],"key":"e60gi","inlineStyleRanges":[],"text":"Create a team site in SharePoint","data":{},"depth":0,"type":"unordered-list-item"},{"type":"unordered-list-item","text":"Deploy Microsoft 365 groups to power platform ","depth":0,"inlineStyleRanges":[],"entityRanges":[{"key":22,"offset":0,"length":45}],"key":"3qv6d","data":{}},{"key":"2fkjq","depth":0,"data":{},"entityRanges":[{"length":33,"key":23,"offset":0}],"inlineStyleRanges":[],"text":"Create a group in Microsoft Teams ","type":"unordered-list-item"},{"entityRanges":[{"offset":0,"key":24,"length":24}],"depth":0,"key":"dfvo","data":{},"type":"unordered-list-item","inlineStyleRanges":[],"text":"Create a group in Yammer "},{"depth":0,"entityRanges":[],"key":"7n81i","data":{},"inlineStyleRanges":[],"text":"Membership type","type":"header-two"},{"data":{},"key":"88a5k","inlineStyleRanges":[],"entityRanges":[],"text":"Up until now, we’ve only discussed “assigned” groups. Assigned Groups are where you have assigned the user to the group. Another group type in Microsoft 365 is Dynamic. Dynamic groups are where the members are automatically added/removed depending on the attributes of the user. For example, you may want to create a security group based on departments. Then every user that has the same department will be automatically added to the group. For example, if the test says, “Users must be added automatically to the security group of their department.” Then a dynamic security group would be required.","depth":0,"type":"unstyled"},{"entityRanges":[],"data":{},"inlineStyleRanges":[],"text":"How to create a dynamic security group","key":"d2v1l","depth":0,"type":"header-three"},{"data":{},"depth":0,"type":"unstyled","inlineStyleRanges":[{"style":"BOLD","length":21,"offset":8},{"length":22,"style":"BOLD","offset":32},{"style":"BOLD","length":6,"offset":57}],"entityRanges":[],"key":"6ok0u","text":"1. Open Azure AD admin center > Azure Active Directory > Groups"},{"inlineStyleRanges":[],"key":"2hudb","text":" ","depth":0,"data":{},"type":"atomic","entityRanges":[{"length":1,"offset":0,"key":25}]},{"entityRanges":[],"depth":0,"text":"2. Click New Group","key":"fbktg","data":{},"type":"unstyled","inlineStyleRanges":[{"length":9,"offset":9,"style":"BOLD"}]},{"data":{},"text":" ","depth":0,"entityRanges":[{"key":26,"length":1,"offset":0}],"inlineStyleRanges":[],"type":"atomic","key":"9eblr"},{"depth":0,"entityRanges":[],"type":"unstyled","data":{},"inlineStyleRanges":[{"offset":64,"length":12,"style":"BOLD"},{"length":17,"style":"BOLD","offset":112}],"text":"3. Enter the Group name > optionally group description > Select Dynamic User under Membership type > Then click Add dynamic query","key":"54er3"},{"text":" ","entityRanges":[{"key":27,"length":1,"offset":0}],"depth":0,"data":{},"type":"atomic","inlineStyleRanges":[],"key":"84v8b"},{"entityRanges":[],"depth":0,"inlineStyleRanges":[{"length":10,"style":"BOLD","offset":23},{"length":6,"style":"BOLD","offset":55},{"offset":85,"style":"BOLD","length":2},{"style":"BOLD","length":4,"offset":100}],"text":"4. Set the property to department. Set the Operator to Equals. Then set the Value to HR. Then click Save.","key":"9u19n","data":{},"type":"unstyled"},{"inlineStyleRanges":[],"data":{},"key":"dd22m","text":" ","entityRanges":[{"offset":0,"key":28,"length":1}],"depth":0,"type":"atomic"},{"depth":0,"data":{},"type":"header-two","text":"Dynamic membership rules","key":"fmvq4","entityRanges":[],"inlineStyleRanges":[]},{"type":"unstyled","entityRanges":[],"key":"53coh","inlineStyleRanges":[],"depth":0,"data":{},"text":"There are several ways to filter / automatically add users to dynamic groups. Let’s review the rules."},{"data":{},"entityRanges":[],"inlineStyleRanges":[],"depth":0,"key":"5hv4k","type":"header-four","text":"Property"},{"type":"unstyled","depth":0,"text":"The property attribute is the property the rule will be checking. In our example above we used the department property which says, “check the department property on each user”.","inlineStyleRanges":[],"data":{},"entityRanges":[],"key":"46i97"},{"text":"Operator","entityRanges":[],"data":{},"key":"nt10","depth":0,"type":"header-four","inlineStyleRanges":[]},{"data":{},"text":"The operator attribute is how to check the property field against the value. We used Equals in the example above. There are a few more operators that should be discussed.","type":"unstyled","key":"98cs9","entityRanges":[],"inlineStyleRanges":[],"depth":0},{"depth":0,"text":"Equals: The equals operator does an exact match (not case sensitive) of the property to the value.","key":"8ki8u","data":{},"inlineStyleRanges":[{"style":"BOLD","length":6,"offset":0}],"entityRanges":[],"type":"unstyled"},{"entityRanges":[],"data":{},"key":"383ia","inlineStyleRanges":[{"length":8,"style":"BOLD","offset":0}],"text":"Contains: The contains operator does partial-string matches but not ","type":"unstyled","depth":0},{"text":"Match: The match operator does a regular expression matching.","depth":0,"inlineStyleRanges":[{"offset":0,"style":"BOLD","length":5}],"data":{},"key":"f8rts","entityRanges":[],"type":"unstyled"},{"inlineStyleRanges":[],"key":"fof22","data":{},"depth":0,"type":"header-three","text":"Dynamic group limits","entityRanges":[]},{"text":"You can create a dynamic group that contains devices or users, but you can't create a group that contains both users and devices.","key":"fd9k7","inlineStyleRanges":[],"depth":0,"type":"unstyled","entityRanges":[],"data":{}},{"type":"unstyled","inlineStyleRanges":[],"depth":0,"data":{},"text":"You can't build a dynamic device group based on the owners' attributes. Device dynamic group rules can only reference the device attributes.","entityRanges":[],"key":"4eri4"},{"entityRanges":[],"key":"a4mlf","depth":0,"text":"Access Review","data":{},"type":"header-two","inlineStyleRanges":[]},{"type":"unstyled","entityRanges":[],"inlineStyleRanges":[],"key":"71pfo","text":"One of the issues with groups is users come and go and they may even switch job roles or departments. Without reviewing the groups to verify membership the user list may get stale and users may keep access to data that they shouldn’t. With Microsoft 365 you can configure access review.","depth":0,"data":{}},{"entityRanges":[],"key":"a18v0","depth":0,"data":{},"inlineStyleRanges":[],"type":"unstyled","text":"With access review, you can set all groups or some of your groups to be reviewed. The reviewer can be the group owners, selected users, or groups, users can review their own access or managers of users. Lastly, you can set how often the reviewers need to perform the review. Let’s take a look."},{"entityRanges":[],"key":"83jbj","data":{},"text":"How to setup access review","depth":0,"type":"header-three","inlineStyleRanges":[]},{"entityRanges":[],"depth":0,"text":"1. Go to Azure AD admin center > Azure Active Directory > Identity Governance.","type":"unstyled","key":"3li4u","inlineStyleRanges":[{"offset":9,"style":"BOLD","length":21},{"offset":33,"style":"BOLD","length":22},{"length":19,"offset":58,"style":"BOLD"}],"data":{}},{"data":{},"type":"atomic","text":" ","key":"44h4d","inlineStyleRanges":[],"entityRanges":[{"length":1,"key":29,"offset":0}],"depth":0},{"depth":0,"inlineStyleRanges":[{"length":14,"offset":3,"style":"BOLD"},{"offset":20,"length":17,"style":"BOLD"}],"key":"3sjfm","type":"unstyled","entityRanges":[],"data":{},"text":"2. Access reviews > New access review."},{"depth":0,"type":"atomic","text":" ","inlineStyleRanges":[],"data":{},"entityRanges":[{"offset":0,"key":30,"length":1}],"key":"5tfl6"},{"key":"b415l","text":"3. In the Select what to review dropdown click Teams + Groups. Click Select Teams + groups. Click select group(s). Click the group you want to perform an access review. Click Select. Click All users. Click Next: Reviews.","entityRanges":[],"type":"unstyled","depth":0,"data":{},"inlineStyleRanges":[{"offset":47,"style":"BOLD","length":14},{"length":21,"style":"BOLD","offset":69},{"offset":98,"length":15,"style":"BOLD"},{"length":6,"style":"BOLD","offset":175},{"length":9,"offset":189,"style":"BOLD"},{"style":"BOLD","length":13,"offset":206}]},{"entityRanges":[{"key":31,"length":1,"offset":0}],"data":{},"inlineStyleRanges":[],"key":"2bah6","depth":0,"text":" ","type":"atomic"},{"entityRanges":[],"type":"unstyled","key":"9bj9q","depth":0,"inlineStyleRanges":[{"offset":50,"length":14,"style":"BOLD"},{"length":14,"style":"BOLD","offset":222}],"data":{},"text":"4. Click the Select reviewers drop down and click Group owner(s). In duration (in days) set the number of days you want the review to be open for. For review recurrence set the amount of time before the next review. Click Next: Settings."},{"entityRanges":[{"key":32,"length":1,"offset":0}],"key":"c3uq3","inlineStyleRanges":[],"text":" ","depth":0,"data":{},"type":"atomic"},{"text":"5. Set Auto apply results to resource. Click Approve access under If reviewers don’t respond. Then click Next: Review + Create.","type":"unstyled","data":{},"depth":0,"inlineStyleRanges":[{"length":30,"offset":7,"style":"BOLD"},{"length":47,"offset":45,"style":"BOLD"},{"offset":105,"style":"BOLD","length":21}],"entityRanges":[],"key":"37c3"},{"data":{},"type":"atomic","key":"auoi5","inlineStyleRanges":[],"entityRanges":[{"length":1,"offset":0,"key":33}],"depth":0,"text":" "},{"key":"6of9v","data":{},"inlineStyleRanges":[{"style":"BOLD","offset":30,"length":6}],"entityRanges":[],"text":"6. Set the review name. Click Create.","depth":0,"type":"unstyled"},{"data":{},"inlineStyleRanges":[],"key":"5hcia","type":"header-two","text":"Group Naming policies","depth":0,"entityRanges":[]},{"inlineStyleRanges":[],"text":"The next thing I’d like to mention is group naming policies. Since users can create groups, you may want to use some sort of naming policy. For example, an organization Contoso may want a prefix in front of all the groups “Contoso-“","type":"unstyled","depth":0,"data":{},"key":"coqv5","entityRanges":[]},{"inlineStyleRanges":[],"type":"unstyled","entityRanges":[],"key":"3v460","data":{},"depth":0,"text":"By setting a group naming policy all users will be required to use your specific naming policy with one exception. Global Admins & User admins can still create groups without using the naming policy."},{"depth":0,"entityRanges":[],"data":{},"inlineStyleRanges":[],"type":"header-three","key":"dit6s","text":"How to set up a naming policy"},{"text":"1. Go to Azure AD admin center > Azure Active Directory > Groups.","depth":0,"entityRanges":[],"data":{},"key":"1dfs2","inlineStyleRanges":[{"offset":9,"style":"BOLD","length":21},{"style":"BOLD","length":22,"offset":33},{"length":6,"offset":58,"style":"BOLD"}],"type":"unstyled"},{"inlineStyleRanges":[],"data":{},"depth":0,"type":"atomic","entityRanges":[{"length":1,"key":34,"offset":0}],"key":"667s3","text":" "},{"data":{},"key":"amra","type":"unstyled","inlineStyleRanges":[{"style":"BOLD","length":13,"offset":9},{"offset":25,"style":"BOLD","length":19},{"style":"BOLD","offset":52,"length":10},{"length":7,"style":"BOLD","offset":84},{"offset":125,"style":"BOLD","length":4}],"entityRanges":[],"depth":0,"text":"2. Click Naming policy > Group naming policy. Click Add prefix. Set the prefix to a string. Then set the prefix value. Click Save."},{"inlineStyleRanges":[],"text":" ","type":"atomic","key":"82u6k","entityRanges":[{"key":35,"length":1,"offset":0}],"data":{},"depth":0},{"type":"header-two","entityRanges":[],"key":"271ba","inlineStyleRanges":[],"depth":0,"text":"Auto-expiration of groups","data":{}},{"data":{},"key":"b8ng9","inlineStyleRanges":[],"text":"So now your Microsoft 365 groups are growing. Sometimes the groups can grow out of control. How do you manage all of them? You put the burden on the group owners. In short, you set the groups to auto-expire. Then the group owners will receive an email where they will need to renew the groups to keep them around. Let's jump in and take a look.","type":"unstyled","entityRanges":[],"depth":0},{"key":"fc0t3","entityRanges":[{"length":10,"key":36,"offset":81}],"data":{},"inlineStyleRanges":[{"style":"BOLD","length":35,"offset":9},{"length":22,"style":"BOLD","offset":47},{"length":7,"offset":72,"style":"BOLD"},{"style":"BOLD","length":10,"offset":81}],"text":"1. Go to Azure Active Directory admin center > Azure Active Directory > Groups > Expiration.","depth":0,"type":"unstyled"},{"key":"1bjn0","entityRanges":[],"data":{},"text":"2. Set the Group lifetime (in days). Set your email in the Email contact for groups with no owners. Set the enable expiration for these Microsoft 365 groups to All. Click Save.","depth":0,"type":"unstyled","inlineStyleRanges":[{"style":"BOLD","length":24,"offset":11},{"offset":59,"length":39,"style":"BOLD"},{"style":"BOLD","length":48,"offset":108},{"style":"BOLD","offset":160,"length":3},{"length":4,"style":"BOLD","offset":171}]},{"data":{},"type":"atomic","key":"ddtob","text":" ","depth":0,"inlineStyleRanges":[],"entityRanges":[{"offset":0,"key":37,"length":1}]},{"text":"","inlineStyleRanges":[],"entityRanges":[],"key":"1g1cq","type":"unstyled","data":{},"depth":0}]},"title":"Creating and managing users through groups","sectionId":"AFV_acckJ","type":"article","datePublished":"2022/5/26","publish":true,"description":"Everything you need to know about groups in Microsoft 365 to pass the MS-500","slug":"Creating-and-managing-users-through-groups-S1hQgFOMV","id":"S1hQgFOMV"},
      articles: [{"id":"cpchjBLkC","sectionId":"qwJW5VrBW","slug":"Whats-in-this-course-cpchjBLkC","title":"What's in this course?","featuredImage":"https://i.ibb.co/zFs9Vfb/microsoft365-security-administrator-associate-600x600.png"},{"id":"KKkBOVuS4","sectionId":"qwJW5VrBW","slug":"Creating-a-free-Microsoft-365-tenant-for-practice-KKkBOVuS4","title":"Creating a free Microsoft 365 tenant for practice","featuredImage":"https://i.ibb.co/F07sjQJ/microsoft-365-e5-trial.png"},{"id":"bzotoOjEe","sectionId":"qwJW5VrBW","slug":"Managing-the-Microsoft-365-tenant-Introduction-to-the-admin-centers-bzotoOjEe","title":"Managing the Microsoft 365 tenant - Introduction to the admin centers","featuredImage":"https://i.ibb.co/f1cr4zt/Microsoft-365-admin-centers.png"},{"id":"cg_vxOX9L","sectionId":"qwJW5VrBW","slug":"Managing-Microsoft-365-through-PowerShell-cg_vxOX9L","title":"Managing Microsoft 365 through PowerShell","featuredImage":"https://i.ibb.co/HV13YF6/install-microsoft-365-powershell-modules.png"},{"id":"uYCIPbnMC","sectionId":"AFV_acckJ","slug":"How-to-create-users-in-Microsoft-365-Cloud-Only-uYCIPbnMC","title":"How to create users in Microsoft 365 Cloud Only","featuredImage":"https://i.ibb.co/Wnt5Q43/View-Microsoft-365-Users.png"},{"id":"7CpqFkPZU","sectionId":"AFV_acckJ","slug":"Creating-and-managing-admins-through-roles-7CpqFkPZU","title":"Creating and managing admins through roles","featuredImage":"https://i.ibb.co/kySL4HQ/Roles-and-administrators.png"},{"id":"rZzausKJ1","sectionId":"AFV_acckJ","slug":"Time-limited-admin-roles-in-Microsoft-365-rZzausKJ1","title":"Time limited admin roles in Microsoft 365","featuredImage":"https://i.ibb.co/nDvjyPD/select-member-to-add-to-PIM-role.png"},{"id":"ky5W0Lz5P","sectionId":"AFV_acckJ","slug":"Whats-AD-Connect-ky5W0Lz5P","title":"What's AD Connect","featuredImage":"https://i.ibb.co/7nDqr9x/Whats-AD-Connect.png"},{"id":"i9pJIjTNH","sectionId":"AFV_acckJ","slug":"Protecting-Passwords-in-Microsoft-365-i9pJIjTNH","title":"Protecting Passwords in Microsoft 365","featuredImage":"https://i.ibb.co/DLD4G4q/access-smart-lockout-settings.png"},{"id":"S1hQgFOMV","sectionId":"AFV_acckJ","slug":"Creating-and-managing-users-through-groups-S1hQgFOMV","title":"Creating and managing users through groups","featuredImage":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png"},{"id":"2QfoI2HxY","sectionId":"AFV_acckJ","slug":"Securing-and-implementing-enterprise-applications-2QfoI2HxY","title":"Securing and implementing enterprise applications","featuredImage":"https://i.ibb.co/C2mp69m/disable-user-consent.png"},{"id":"V1en9Iugh","sectionId":"AFV_acckJ","slug":"Whats-a-conditional-access-policy-V1en9Iugh","title":"What's a conditional access policy?","featuredImage":"https://i.ibb.co/DQm1sY0/Create-conditional-access-policy.png"},{"id":"nAAIvNbtk","sectionId":"AFV_acckJ","slug":"The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk","title":"The many ways to implement multi-factor authentication (MFA) in Microsoft 365","featuredImage":"https://i.ibb.co/P1P0wNY/microsoft-365-manage-security-defaults.png"},{"id":"2S9jn0aLr","sectionId":"AFV_acckJ","slug":"Implement-Self-service-password-reset-in-Microsoft-365-2S9jn0aLr","title":"Implement Self-service password reset in Microsoft 365","featuredImage":"https://i.ibb.co/58y9JVg/write-back-passwords-to-on-premises-directory.png"},{"id":"FldNualGC","sectionId":"AFV_acckJ","slug":"Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC","title":"Locking down your Microsoft 365 tenant from Microsoft engineers","featuredImage":"https://i.ibb.co/DCmpnT9/Enable-Customer-Lockbox.png"},{"id":"NFQ6rYFeQ","sectionId":"AFV_acckJ","slug":"Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ","title":"Implementing intelligent security using risk policies in Microsoft 365","featuredImage":"https://i.ibb.co/0cyQJ7j/Risk-Detections.png"},{"id":"rK48f6iM2","sectionId":"AFV_acckJ","slug":"Automating-Access-Review-in-Microsoft-365-rK48f6iM2","title":"Automating Access Review in Microsoft 365","featuredImage":"https://i.ibb.co/Xsxvz6Z/new-access-review.png"},{"id":"RHW1API2s","sectionId":"AFV_acckJ","slug":"Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s","title":"Just in time, approval and notification for admin roles in Microsoft 365","featuredImage":"https://i.ibb.co/dcb6XFN/Activate-a-Role.png"},{"id":"z8EMM9Eu_","sectionId":"QScYfSu74","slug":"Whats-Microsoft-365-Defender-z8EMM9Eu_","title":"What's Microsoft 365 Defender?","featuredImage":"https://i.ibb.co/MDMyDQt/Microsoft-Defender.png"},{"id":"Kye_yNLxA","sectionId":"QScYfSu74","slug":"Whats-Microsoft-Defender-for-identity-Kye_yNLxA","title":"What's Microsoft Defender for identity?","featuredImage":"https://i.ibb.co/bQDBh0Y/Defender-for-Identity-Timeline.png"},{"id":"EnPyp7ukN","sectionId":"QScYfSu74","slug":"Whats-Microsoft-Defender-for-Office-365-EnPyp7ukN","title":"What's Microsoft Defender for Office 365?","featuredImage":"https://i.ibb.co/WcwKY2G/Microsoft-365-incidents-and-alerts.png"},{"id":"6HUOr7qbL","sectionId":"QScYfSu74","slug":"Protect-your-email-environment-from-malicious-actors-6HUOr7qbL","title":"Protect your email and Office environment from malicious actors","featuredImage":"https://i.ibb.co/Df0KQVp/Reports.png"},{"id":"GCOOUsSBT","sectionId":"QScYfSu74","slug":"Protecting-email-against-phishing-attacks-GCOOUsSBT","title":"Protecting email against phishing attacks","featuredImage":"https://i.ibb.co/GCjZHWg/edit-actions.png"},{"id":"GG4cMY8pK","sectionId":"QScYfSu74","slug":"Simulating-attacks-with-Microsoft-365-GG4cMY8pK","title":"Simulating attacks with Microsoft 365","featuredImage":"https://i.ibb.co/NyvnbMK/simulation-overview-view-users-circled.png"},{"id":"z0qPG6v4T","sectionId":"QScYfSu74","slug":"Protecting-Windows-10-and-other-devices-with-Microsoft-Defender-for-Endpoint-z0qPG6v4T","title":"Protecting Windows 10 and other devices with Microsoft Defender for Endpoint","featuredImage":"https://i.ibb.co/T47Xhyh/enable-endpoint-connections.png"},{"id":"LEyZMWBSt","sectionId":"QScYfSu74","slug":"Collect-detect-investigate-and-respond-to-security-threats-using-Microsoft-Sentinel-LEyZMWBSt","title":"Collect, detect, investigate, and respond to security threats using Microsoft Sentinel","featuredImage":"https://i.ibb.co/qN9XsKj/Add-Workbook.png"},{"id":"7MQ3wE4wP","sectionId":"QScYfSu74","slug":"Implement-and-manage-Microsoft-Defender-for-Cloud-Apps-7MQ3wE4wP","title":"Implement and manage Microsoft Defender for Cloud Apps","featuredImage":"https://i.ibb.co/7g7LvFg/office-365-cloud-apps-settings.png"},{"id":"sH_Ee1DW1","sectionId":"QScYfSu74","slug":"Auditing-sign-ins-and-other-actions-in-Microsoft-365-sH_Ee1DW1","title":"Auditing sign-ins and other actions in Microsoft 365","featuredImage":"https://i.ibb.co/BqMw3jZ/Start-recording-user-and-admin-activity.png"},{"id":"vLweLmxZf","sectionId":"YhftdGIRX","slug":"How-to-classify-data-using-labels-in-Microsoft-365-vLweLmxZf","title":"How to classify data using labels in Microsoft 365","featuredImage":"https://i.ibb.co/k9nhWS5/Choose-protection-settings-for-files-and-emails.png"},{"id":"NsF7No40f","sectionId":"YhftdGIRX","slug":"Creating-and-managing-data-retention-to-conform-to-compliance-NsF7No40f","title":"Creating and managing data retention to conform to compliance","featuredImage":"https://i.ibb.co/yqC0ZdY/New-Retention-Policy.png"},{"id":"IsPGsme8w","sectionId":"YhftdGIRX","slug":"Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w","title":"Preventing accidental and malicious data loss with DLP policies","featuredImage":"https://i.ibb.co/n8WcqKM/Create-a-DLP-policy.png"},{"id":"wv2PbXnhI","sectionId":"YhftdGIRX","slug":"Everything-you-need-to-know-about-securing-SharePoint-Online-for-the-MS-500-wv2PbXnhI","title":"Everything you need to know about securing SharePoint Online for the MS-500","featuredImage":"https://i.ibb.co/Gk9NjSH/Share-Point-Online-Warning.png"},{"id":"7gR3L122b","sectionId":"l0DxUuonW","slug":"Introduction-to-Intune-7gR3L122b","title":"Introduction to Intune","featuredImage":"https://i.ibb.co/Fq3N8BX/Endpoint-Manager-Admin-Center.png"},{"id":"ZyKX3Idjs","sectionId":"l0DxUuonW","slug":"Setting-up-Android-Devices-ZyKX3Idjs","title":"Setting up Android Devices","featuredImage":"https://i.ibb.co/m0BYhL2/Connect-Intune-to-Google-Play.png"},{"id":"MAjW0a2_p","sectionId":"l0DxUuonW","slug":"Setting-up-Apple--iOS-devices-in-Intune-MAjW0a2_p","title":"Setting up Apple / iOS devices in Intune","featuredImage":"https://i.ibb.co/X7Ffb2B/Setup-Apple-Enrollment-in-Intune.png"},{"id":"XFXu2zIS9","sectionId":"l0DxUuonW","slug":"Setting-up-Windows-10-devices-in-Intune-XFXu2zIS9","title":"Setting up Windows 10 devices in Intune","featuredImage":"https://i.ibb.co/WDXKVjW/configure-device-options.png"},{"id":"_LL9VqGZO","sectionId":"l0DxUuonW","slug":"How-to-manage-devices-using-Intune-_LL9VqGZO","title":"How to manage devices using Intune","featuredImage":"https://i.ibb.co/HPQ2m8t/Create-an-endpoint-protection-profile.png"},{"id":"qDRA4jjoN","sectionId":"l0DxUuonW","slug":"Understanding-compliance-policies-qDRA4jjoN","title":"Understanding compliance policies","featuredImage":"https://i.ibb.co/N3Qk57v/Create-a-compliance-policy.png"},{"id":"62t_7oiZx","sectionId":"l0DxUuonW","slug":"Restricting-and-managing-apps-on-user-devices-62t_7oiZx","title":"Restricting and managing apps on user devices","featuredImage":"https://i.ibb.co/PCVRKDf/Add-an-Android-app-to-Intune.png"}],
      articleHtml: `<p>re are four types of groups in Microsoft 365: distribution, security groups, mail-enabled security, and Microsoft 365. Let’s dive right into the types of groups.</p>
<h2>Distribution groups</h2>
<p>Distribution groups also known as distribution lists will create an email address and distribute the emails to all the members of the group. Distribution groups do not have separate mailboxes. The emails land in the members of the distribution lists mailboxes. You can add anyone with a mailbox inside your organization and you can add mail contacts to distribution groups.</p>
<h3>Create a distribution group in Microsoft 365</h3>
<p>1. Go to the <strong>Microsoft 365 admin center</strong> &gt; <strong>Teams &amp; groups</strong> &gt; <strong>Active teams &amp; groups</strong>. Then click <a href="https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard" target="_blank"><strong>Add a group</strong></a>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png" alt="Add a group to Microsoft 365" style="height: auto;width: auto"/></div>
<p>2. Click <strong>Distribution </strong>&gt; <strong>Next</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/104HV6d/create-a-distribution-group.png" alt="create a distribution group" style="height: auto;width: auto"/></div>
<p>3. Name the group. Optionally add a description. Click <strong>Next</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/zQJ9x1M/name-your-new-group.png" alt="Name your new Microsoft 365 group" style="height: auto;width: auto"/></div>
<p>4. Set the group email address. Optionally click <strong>Allow people outside of my organization to send email to this Distribution group</strong>. Click <strong>Next</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/nLrY8x6/new-group-email-address.png" alt="New group email address" style="height: auto;width: auto"/></div>
<p>5. Click <strong>Create group</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/xM6DN61/create-distribution-group.png" alt="create distribution group" style="height: auto;width: auto"/></div>
<h3>Add members to the distribution group</h3>
<p>You’ll notice you can’t add members to the group while creating the group. To add members, you’ll need to go to the group and manage the members.</p>
<p>1. Go to the <strong>Microsoft 365 admin center</strong> &gt; <strong>Teams &amp; groups</strong> &gt; <a href="https://admin.microsoft.com/Adminportal/Home?source=applauncher#/groups" target="_blank"><strong>Active teams &amp; groups</strong></a> &gt; <strong>Distribution List</strong>.  Then click the group you want to manage.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/4frD0dC/manage-distribution-group.png" alt="manage distribution group" style="height: auto;width: auto"/></div>
<p>2. Click <strong>Members</strong> &gt; <strong>View all and manage members</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/YhY7R2R/manage-members-of-distribution-group.png" alt="manage members of distribution group" style="height: auto;width: auto"/></div>
<p>3. Click <strong>Add members</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/5n13V6V/add-members-to-group.png" alt="add members to group" style="height: auto;width: auto"/></div>
<p>4. Select the users you want to add to the group. Then click <strong>Add</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/FmHL7tG/add-members-to-the-group.png" alt="Add members to the group" style="height: auto;width: auto"/></div>
<h2>Security groups</h2>
<p>Microsoft 365 security groups, formerly known as Office 365 security groups, allow admins to manage access to resources, for example, SharePoint, Intune, or apply conditional access policies.</p>
<h3>Create a security group in Microsoft 365</h3>
<p>1. Go to the <strong>Microsoft 365 admin center</strong> &gt; <strong>Teams &amp; groups</strong> &gt; <strong>Active teams &amp; groups</strong>. Then click <a href="https://admin.microsoft.com/Adminportal/Home?source=applauncher#/addgroupwizard" target="_blank"><strong>Add a group</strong></a></p>
<div style="text-align:none;"><img src="https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png" alt="Add a group to Microsoft 365" style="height: auto;width: auto"/></div>
<p>2. Click <strong>Security</strong> &gt; <strong>Next</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/bbX5gBD/create-a-security-group.png" alt="Create a security group" style="height: auto;width: auto"/></div>
<p>3. Name the group. Optionally add a description. Click <strong>Next</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/zQJ9x1M/name-your-new-group.png" alt="Name your new Microsoft 365 group" style="height: auto;width: auto"/></div>
<p>4. Click <strong>Create group</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/TTf23Bz/create-security-group.png" alt="Create security group" style="height: auto;width: auto"/></div>
<h3>Add members to the security group</h3>
<p>To add members, you’ll need to go to the group and manage the members.</p>
<p>1. Go to the <strong>Microsoft 365 admin center</strong> &gt; <strong>Teams &amp; groups</strong> &gt; <strong>Active teams &amp; groups</strong> &gt; <strong>Security</strong>. Then click the group you want to manage</p>
<p>2. Click <strong>Members</strong> &gt; <strong>View all and manage members</strong>.</p>
<p>3. Click <strong>Add members</strong>.</p>
<p>4. Select the users you want to add to the group. Then click <strong>Add</strong>.</p>
<h2>Mail-enabled security groups</h2>
<p>Mail-enabled security groups are the best of both worlds. Use mail-enabled security groups to distribute messages and grant access permissions to resources in Microsoft 365.</p>
<p>You create mail-enabled security groups the same way you create security/distribution groups.</p>
<h2>Microsoft 365 groups</h2>
<p>Microsoft 365 groups allow users to create and manage their own teams. Microsoft 365 groups can create Microsoft Teams, shared mailboxes, or open discussion forums in Yammer. They can also be used in SharePoint sites, Planner, OneDrive shared libraries, Power BI and more. Note, I said can because depending on where you create the team it will change what is created along with it.</p>
<h3>How to create a Microsoft 365 group with a shared mailbox</h3>
<p>1. Open Outlook.</p>
<p>2. Right-click Groups in the left pane and click New Group.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/ySVxbWK/new-microsoft-365-group.png" alt="Create a new Microsoft 365 group in Outlook" style="height: auto;width: auto"/></div>
<p>3. Set the name, email address, description, privacy, and decide if you want the emails to go to everyone’s mailboxes. Then click <strong>Create</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/wR07Y6n/create-group-in-outlook.png" alt="Create Microsoft 365 group in Outlook" style="height: auto;width: auto"/></div>
<p>4. Enter the other members' names. Click the member to add them. Click <strong>Add Members</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/TkpzRv9/add-members-to-outlook-group.png" alt="Add members to outlook group" style="height: auto;width: auto"/></div>
<h3>How to create a Microsoft 365 group in other apps</h3>
<p>Since knowing all the ways to create a Microsoft 365 group is outside the scope of MS-500 I’ll simply link the instructions below:</p>
<ul>
<li><a href="https://support.office.com/en-us/article/create-a-plan-in-microsoft-planner-93e65b03-6fac-4661-a502-e3161475ab93" target="_blank">Create a plan in Microsoft Planner</a></li>
<li><a href="https://support.office.com/en-us/article/create-a-group-in-outlook-04d0c9cf-6864-423c-a380-4fa858f27102" target="_blank">Create a group in Microsoft Outlook</a></li>
<li><a href="https://support.office.com/en-us/article/create-a-team-site-in-sharepoint-online-ef10c1e7-15f3-42a3-98aa-b5972711777d" target="_blank">Create a team site in SharePoint</a></li>
<li><a href="https://docs.microsoft.com/en-us/dynamics365/customer-engagement/admin/deploy-office-365-groups" target="_blank">Deploy Microsoft 365 groups to power platform</a>&nbsp;</li>
<li><a href="https://docs.microsoft.com/en-us/microsoftteams/office-365-groups" target="_blank">Create a group in Microsoft Teams</a>&nbsp;</li>
<li><a href="https://support.office.com/en-us/article/create-a-group-in-yammer-b407af4f-9a58-4b12-b43e-afbb1b07c889" target="_blank">Create a group in Yammer</a>&nbsp;</li>
</ul>
<h2>Membership type</h2>
<p>Up until now, we’ve only discussed “assigned” groups. Assigned Groups are where you have assigned the user to the group. Another group type in Microsoft 365 is Dynamic. Dynamic groups are where the members are automatically added/removed depending on the attributes of the user. For example, you may want to create a security group based on departments. Then every user that has the same department will be automatically added to the group. For example, if the test says, “Users must be added automatically to the security group of their department.” Then a dynamic security group would be required.</p>
<h3>How to create a dynamic security group</h3>
<p>1. Open <strong>Azure AD admin center</strong> &gt; <strong>Azure Active Directory</strong> &gt; <strong>Groups</strong></p>
<div style="text-align:none;"><img src="https://i.ibb.co/xMzW2hd/azure-ad-groups.png" alt="Azure AD Groups" style="height: auto;width: auto"/></div>
<p>2. Click <strong>New Group</strong></p>
<div style="text-align:none;"><img src="https://i.ibb.co/LzXYCTW/azure-ad-new-group.png" alt="Azure AD New Group" style="height: auto;width: auto"/></div>
<p>3. Enter the Group name &gt; optionally group description &gt; Select <strong>Dynamic User</strong> under Membership type &gt; Then click <strong>Add dynamic query</strong></p>
<div style="text-align:none;"><img src="https://i.ibb.co/Kq64m2j/New-dynamic-group.png" alt="Create a new dynamic group" style="height: auto;width: auto"/></div>
<p>4. Set the property to <strong>department</strong>. Set the Operator to <strong>Equals</strong>. Then set the Value to <strong>HR</strong>. Then click <strong>Save</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/JBzmGBQ/dyanmic-membership-rules.png" alt="Dynamic membership rules" style="height: auto;width: auto"/></div>
<h2>Dynamic membership rules</h2>
<p>There are several ways to filter / automatically add users to dynamic groups. Let’s review the rules.</p>
<h4>Property</h4>
<p>The property attribute is the property the rule will be checking. In our example above we used the department property which says, “check the department property on each user”.</p>
<h4>Operator</h4>
<p>The operator attribute is how to check the property field against the value. We used Equals in the example above. There are a few more operators that should be discussed.</p>
<p><strong>Equals</strong>: The equals operator does an exact match (not case sensitive) of the property to the value.</p>
<p><strong>Contains</strong>: The contains operator does partial-string matches but not&nbsp;</p>
<p><strong>Match</strong>: The match operator does a regular expression matching.</p>
<h3>Dynamic group limits</h3>
<p>You can create a dynamic group that contains devices or users, but you can't create a group that contains both users and devices.</p>
<p>You can't build a dynamic device group based on the owners' attributes. Device dynamic group rules can only reference the device attributes.</p>
<h2>Access Review</h2>
<p>One of the issues with groups is users come and go and they may even switch job roles or departments. Without reviewing the groups to verify membership the user list may get stale and users may keep access to data that they shouldn’t. With Microsoft 365 you can configure access review.</p>
<p>With access review, you can set all groups or some of your groups to be reviewed. The reviewer can be the group owners, selected users, or groups, users can review their own access or managers of users. Lastly, you can set how often the reviewers need to perform the review. Let’s take a look.</p>
<h3>How to setup access review</h3>
<p>1. Go to <strong>Azure AD admin center</strong> &gt; <strong>Azure Active Directory</strong> &gt; <strong>Identity Governance</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/vP17HPH/Azure-AD-Identity-Governance.png" alt="Azure AD Identity Governance" style="height: auto;width: auto"/></div>
<p>2. <strong>Access reviews</strong> &gt; <strong>New access review</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/bXKkwKH/new-access-review.png" alt="new access review" style="height: auto;width: auto"/></div>
<p>3. In the Select what to review dropdown click <strong>Teams + Groups</strong>. Click <strong>Select Teams + groups</strong>. Click <strong>select group(s)</strong>. Click the group you want to perform an access review. Click <strong>Select</strong>. Click <strong>All users</strong>. Click <strong>Next: Reviews</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/ggzVL3L/access-review-review-type2.png" alt="Create new access review Review Type page" style="height: auto;width: auto"/></div>
<p>4. Click the Select reviewers drop down and click <strong>Group owner(s)</strong>. In duration (in days) set the number of days you want the review to be open for. For review recurrence set the amount of time before the next review. Click <strong>Next: Settings</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/DMZz1sY/Access-review-reviews2.png" alt="New access review reviews page" style="height: auto;width: auto"/></div>
<p>5. Set <strong>Auto apply results to resource</strong>. Click <strong>Approve access under If reviewers don’t respond</strong>. Then click <strong>Next: Review + Create</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/3RtXhW7/access-review-settings.png" alt="Set the access review settings" style="height: auto;width: auto"/></div>
<p>6. Set the review name. Click <strong>Create</strong>.</p>
<h2>Group Naming policies</h2>
<p>The next thing I’d like to mention is group naming policies. Since users can create groups, you may want to use some sort of naming policy. For example, an organization Contoso may want a prefix in front of all the groups “Contoso-“</p>
<p>By setting a group naming policy all users will be required to use your specific naming policy with one exception. Global Admins &amp; User admins can still create groups without using the naming policy.</p>
<h3>How to set up a naming policy</h3>
<p>1. Go to <strong>Azure AD admin center</strong> &gt; <strong>Azure Active Directory</strong> &gt; <strong>Groups</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/ZSKQgj7/naming-policy-navigation.png" alt="Azure AD Groups Navigation" style="height: auto;width: auto"/></div>
<p>2. Click <strong>Naming policy</strong> &gt; <strong>Group naming policy</strong>. Click <strong>Add prefix</strong>. Set the prefix to a <strong>string.</strong> Then set the prefix value. Click <strong>Save</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/FD4vJbd/configure-group-naming-policy.png" alt="Configure group naming policy" style="height: auto;width: auto"/></div>
<h2>Auto-expiration of groups</h2>
<p>So now your Microsoft 365 groups are growing. Sometimes the groups can grow out of control. How do you manage all of them? You put the burden on the group owners. In short, you set the groups to auto-expire. Then the group owners will receive an email where they will need to renew the groups to keep them around. Let's jump in and take a look.</p>
<p>1. Go to <strong>Azure Active Directory admin center</strong> &gt; <strong>Azure Active Directory</strong> &gt; <strong>Groups </strong>&gt; <a href="https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/GroupsManagementMenuBlade/Lifecycle" target="_blank"><strong>Expiration</strong></a>.</p>
<p>2. Set the <strong>Group lifetime (in days)</strong>. Set your email in the <strong>Email contact for groups with no owners</strong>. Set the <strong>enable expiration for these Microsoft 365 groups</strong> to <strong>All</strong>. Click <strong>Save</strong>.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/cxPHf87/set-group-expiration.png" alt="set group expiration" style="height: auto;width: auto"/></div>
<p></p>
`,
      nextContentSlug: 'Securing-and-implementing-enterprise-applications-2QfoI2HxY',
      previousContentSlug: 'Protecting-Passwords-in-Microsoft-365-i9pJIjTNH',
      hasCompletedContent: false,
      userAcct: {completedContent: []}
    }
  }

  componentDidMount() {
    this.onAuthStateChangedListener = onAuthStateChanged((user) => {
      if (user) {
        getDoc('courses/MS-500/users', user.uid).then((userAcct) => {
          if (!userAcct.completedContent) {
            userAcct.completedContent = []
          }
          this.setState({userAcct})
        })
      }
    })

    if (isBrowser()) {
      document.addEventListener('scroll', this.trackScrolling)
      this.setState({isTrackScrolling: true})
    }

    if (this.state.course.COURSE) {
      getDoc('courses', 'MS-500').then((course) => {
        this.setState({course})

        if (this.state.articles[0] === 'ARTICLES') {
          getAllDocs('courses/MS-500/contents').then((articles) => {
            const contentSorted = sort(course, articles)
            this.setState({ articles: contentSorted })

            if (this.state.article.ARTICLE) {
              getDoc('courses/MS-500/contents', '2QfoI2HxY').then((article) => {
                const articleHtml = draftToHtml(article.article)

                const idx = course.contentOrder.indexOf(article.id)

                const nextContentSlug = idx < articles.length - 1 ? contentSorted[idx + 1].slug : this.state.nextContentSlug
                const previousContentSlug = idx > 0 ? contentSorted[idx - 1].slug : this.state.previousContentSlug

                this.setState({article, articleHtml, nextContentSlug, previousContentSlug})
              })
            }
          })
        }
      })
    }
  }

  componentWillUnmount() {
    if (isBrowser() && this.state.isTrackScrolling)
      document.removeEventListener('scroll', this.trackScrolling);

    this.onAuthStateChangedListener()
  }

  trackScrolling() {
    if (document.body.scrollHeight * .8 < window.innerHeight + window.scrollY) {
      this.setHasCompletedContent(true)
    }
  }

  setHasCompletedContent(val) {
    if (val === true) {
      document.removeEventListener('scroll', this.trackScrolling);
      this.setState({isTrackScrolling: false})

      if (this.state.userAcct.id) {
        const userAcct = this.state.userAcct

        if (!userAcct.completedContent.includes(this.state.article.id)) {
          userAcct.completedContent.push(this.state.article.id)
          this.setState({userAcct})
          saveDoc('courses/MS-500/users', userAcct)
        }
      }
    }
  }

  render() {
    const jsonLd = {
      headline: this.state.article.title,
      datePublished: this.state.article.datePublished,
      keywords: [
        "Microsoft",
        "Microsoft 365",
        "Office 365",
        'MS-500',
        'Microsoft 365 Security Administration'
      ],
      "author": {
        "@type": "Person",
        "name": "John Gruber",
        url: 'https://medium.com/@gruberjl'
      }
    }

    return (
      <Page jsonLdType={'BlogPosting'} jsonLd={jsonLd} image={this.state.article.featuredImage} canonical={this.props.location.href} title={this.state.article.title} description={this.state.article.description}>
        <main>
          <Container fluid>
            <Row>
              <Col lg={9}>
                <Container>
                  <h1 style={marginTop24Style}>{this.state.article.title}</h1>
                  <div dangerouslySetInnerHTML={{__html: this.state.articleHtml}} className='img-width-100 article'></div>
                  <div className='flex-space-between margin12'>
                    <Link to={ this.state.previousContentSlug === 'PREVIOUS_CONTENT' ? '/' : `/course/ms-500/learn/${this.state.previousContentSlug}` }><IoChevronBack /> Previous</Link>
                    <Link to={ this.state.nextContentSlug === 'NEXT_CONTENT' ? '/' : `/course/ms-500/learn/${this.state.nextContentSlug}` }>Next <IoChevronForward /></Link>
                  </div>
                </Container>
              </Col>
              <Col lg={3}>
                <Accordion defaultActiveKey="0">
                  {this.state.course.sections.map((section, idx) => (
                    <Accordion.Item eventKey={idx} key={idx}>
                      <Accordion.Header>{section.title}</Accordion.Header>
                      <Accordion.Body style={removePaddingStyle}>
                        <ListGroup defaultActiveKey={`/course/ms-500/learn/${this.state.currentSlug}`} variant="flush">
                          { this.state.articles.filter(article => article.sectionId === section.id).map((article, articleIdx) => (
                            <ListGroup.Item style={listItemStyle} action to={`/course/ms-500/learn/${article.slug}`} href={`/course/ms-500/learn/${article.slug}`} as={Link} key={articleIdx} className='navigation-item'>
                              <Form.Check label={article.title} checked={this.state.userAcct.completedContent.includes(article.id)} onChange={() => {}} />
                            </ListGroup.Item>
                          ))}
                        </ListGroup>
                      </Accordion.Body>
                    </Accordion.Item>
                  ))}
                </Accordion>
              </Col>
            </Row>
          </Container>
        </main>
      </Page>
    )
  }
}

export default ArticlePage
