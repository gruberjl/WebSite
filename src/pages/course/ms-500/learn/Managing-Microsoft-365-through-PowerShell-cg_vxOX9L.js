import * as React from "react"
import Page from '../../../../components/page'
import Container from 'react-bootstrap/Container'
import Row from 'react-bootstrap/Row'
import Col from 'react-bootstrap/Col'
import Accordion from 'react-bootstrap/Accordion'
import ListGroup from 'react-bootstrap/ListGroup'
import Form from 'react-bootstrap/Form'
import { Link } from "gatsby"
import {getDoc, getAllDocs, saveDoc, onAuthStateChanged} from '../../../../components/firebase'
import draftToHtml from 'draftjs-to-html'
import { IoChevronBack, IoChevronForward } from "react-icons/io5";

const isBrowser = () => typeof window !== 'undefined'
 
const removePaddingStyle = {
  padding: '0px'
}

const marginTop24Style = {
  marginTop: '24px'
}

const listItemStyle = {
  border: 'none',
  paddingTop: '12px',
  paddingBottom: '12px'
}

const sort = (course, articles) => {
  return articles.sort((a, b) => {
    return course.contentOrder.indexOf(a.id) - course.contentOrder.indexOf(b.id)
  })
}

class ArticlePage extends React.Component {
  constructor(props) {
    super(props)
    this.trackScrolling = this.trackScrolling.bind(this)
    this.setHasCompletedContent = this.setHasCompletedContent.bind(this)

    let currentSlug = props.location.pathname.replace('/course/ms-500/learn/', '').split('/')[0]
    if (currentSlug === 'article')
      currentSlug = 'Securing-and-implementing-enterprise-applications-2QfoI2HxY'

    this.state = {
      currentSlug: currentSlug,
      isTrackScrolling: false,
      course: {"sections":[{"order":0,"id":"qwJW5VrBW","title":"Introduction"},{"order":1,"title":"Securing identity and access to Microsoft 365","id":"AFV_acckJ"},{"title":"Securing Microsoft 365, clouds, and on-premises environments","order":2,"id":"QScYfSu74"},{"title":"Protecting your environment from accidental and malicious data loss","id":"YhftdGIRX","order":3},{"title":"Protecting User devices using Intune","id":"l0DxUuonW","order":4}],"description":"Learn, prepare and training for the Microsoft Microsoft Office 365 Exam MS-500: Microsoft 365 Security Administration MS-500 exam","id":"MS-500","title":"Training for MS-500: Microsoft Office 365 Security Admin","audience":"Anyone who wants to learn about securing Microsoft 365","contentOrder":["cpchjBLkC","KKkBOVuS4","bzotoOjEe","cg_vxOX9L","uYCIPbnMC","7CpqFkPZU","rZzausKJ1","ky5W0Lz5P","i9pJIjTNH","S1hQgFOMV","2QfoI2HxY","V1en9Iugh","nAAIvNbtk","2S9jn0aLr","FldNualGC","NFQ6rYFeQ","rK48f6iM2","RHW1API2s","z8EMM9Eu_","Kye_yNLxA","EnPyp7ukN","6HUOr7qbL","GCOOUsSBT","GG4cMY8pK","z0qPG6v4T","LEyZMWBSt","7MQ3wE4wP","sH_Ee1DW1","vLweLmxZf","NsF7No40f","IsPGsme8w","wv2PbXnhI","7gR3L122b","ZyKX3Idjs","MAjW0a2_p","XFXu2zIS9","_LL9VqGZO","qDRA4jjoN","62t_7oiZx"]},
      article: {"description":"How to connect to all Microsoft 365 services through PowerShell","pushlish":true,"id":"cg_vxOX9L","article":{"entityMap":{"0":{"type":"IMAGE","mutability":"MUTABLE","data":{"alignment":"none","src":"https://i.ibb.co/31fXgzV/Power-Shell.png","width":"auto","height":"auto","alt":"Access PowerShell"}},"1":{"mutability":"MUTABLE","type":"LINK","data":{"targetOption":"_blank","height":"auto","url":"https://download.microsoft.com/download/7/1/E/71EF1D05-A42C-4A1F-8162-96494B5E615C/msoidcli_32bit.msi","alt":"Open PowerShell as an admin","src":"https://i.ibb.co/4WfH7pW/powershell-as-admin.png","width":"auto"}},"2":{"type":"IMAGE","data":{"alt":"Open PowerShell as an admin","width":"auto","height":"auto","src":"https://i.ibb.co/4WfH7pW/powershell-as-admin.png"},"mutability":"MUTABLE"},"3":{"type":"IMAGE","mutability":"MUTABLE","data":{"height":"auto","width":"auto","src":"https://i.ibb.co/tYJ6H9X/Power-Shell-Allow-this-app.png","alt":"PowerShell Allow open as admin"}},"4":{"type":"IMAGE","data":{"width":"auto","src":"https://i.ibb.co/qyMttBg/install-nuget.png","alt":"Install NuGet","height":"auto"},"mutability":"MUTABLE"},"5":{"mutability":"MUTABLE","type":"IMAGE","data":{"height":"auto","width":"auto","alt":"Install Microsoft 365 PowerShell Modules","src":"https://i.ibb.co/HV13YF6/install-microsoft-365-powershell-modules.png"}},"6":{"type":"IMAGE","mutability":"MUTABLE","data":{"src":"https://i.ibb.co/1mnGG2H/set-executionpolicy.png","width":"auto","alt":"Set-ExecutionPolicy RemoteSigned","height":"auto"}},"7":{"mutability":"MUTABLE","type":"IMAGE","data":{"alt":"Connect to Microsoft 365 PowerShell - Enter Username","src":"https://i.ibb.co/hdMWybz/connect-to-microsoft-365.png","width":"auto","height":"auto"}},"8":{"mutability":"MUTABLE","data":{"height":"auto","width":"auto","alt":"Microsoft 365 PowerShell Sign in Enter Password","src":"https://i.ibb.co/0VgpjZ3/connect-to-microsoft-365-enter-password.png"},"type":"IMAGE"},"9":{"data":{"alt":"P{owerShell command Get-Help Get-MsolUser","width":"auto","src":"https://i.ibb.co/4Rs6bkV/get-help-get-msoluser.png","height":"auto"},"type":"IMAGE","mutability":"MUTABLE"},"10":{"mutability":"MUTABLE","type":"IMAGE","data":{"height":"auto","alt":"PowerShell running Get-Help Get-MsolUser -Example","width":"auto","src":"https://i.ibb.co/HdW0MVN/get-help-get-msoluser-examples.png"}},"11":{"data":{"targetOption":"_blank","url":"https://gitbit-my.sharepoint.com/:x:/g/personal/john_gruber_gitbit_org/EQ0d0msWFOtGjxpFbMfgqd8Bk8BUclseahXPgO4dB4ZKcw?e=XB4FQq"},"mutability":"MUTABLE","type":"LINK"},"12":{"data":{"url":"https://gitbit-my.sharepoint.com/:x:/g/personal/john_gruber_gitbit_org/EQwm_H3-5SFOkqV8qvhklBQB225Fdz4GfV1grM-6_Nl41w?e=yOljjN","targetOption":"_blank"},"type":"LINK","mutability":"MUTABLE"},"13":{"data":{"url":"https://admin.microsoft.com/Adminportal/Home?source=applauncher#/alladmincenters","targetOption":"_blank"},"type":"LINK","mutability":"MUTABLE"},"14":{"data":{"src":"https://i.ibb.co/xMS0rB1/sharepoint-admin-center.png","alignment":"none","alt":"Open SharePoint admin center","height":"auto","width":"auto"},"mutability":"MUTABLE","type":"IMAGE"},"15":{"type":"IMAGE","data":{"width":"auto","src":"https://i.ibb.co/BKbHN2x/Share-Point-url.png","alt":"Copy the SharePoint URL","height":"auto"},"mutability":"MUTABLE"},"16":{"type":"IMAGE","mutability":"MUTABLE","data":{"src":"https://i.ibb.co/pPgzDsj/connect-to-sharepoint-online-using-powershell.png","height":"auto","width":"auto","alt":"Connect the SharePoint Online using PowerShell"}}},"blocks":[{"inlineStyleRanges":[],"text":"What's PowerShell?","key":"9tq4i","type":"header-two","data":{},"entityRanges":[],"depth":0},{"type":"unstyled","inlineStyleRanges":[],"key":"aipuu","entityRanges":[],"text":"The best way to explain PowerShell is directly from Microsoft:","depth":0,"data":{}},{"key":"a6cad","entityRanges":[],"type":"blockquote","data":{},"inlineStyleRanges":[],"depth":0,"text":"PowerShell is a cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework. PowerShell runs on Windows, Linux, and macOS."},{"depth":0,"text":"To put it another way, PowerShell is a command-line + a scripting language combined. It's a powerful tool that can be used to automate actions on your computer as well as actions in Microsoft 365. But it doesn't manage Microsoft 365 out of the box. You first have to extend it which can be done using modules.","data":{},"key":"41u92","inlineStyleRanges":[],"type":"unstyled","entityRanges":[]},{"depth":0,"type":"header-two","data":{},"text":"Why PowerShell?","entityRanges":[],"key":"7i9lc","inlineStyleRanges":[]},{"entityRanges":[],"text":"From PowerShell, you can make changes in bulk. For example, you can connect to Microsoft 365 using PowerShell, get a list of unlicensed users and license them all. All from a single script. You can also export data. Need a list of all the users or all the mailboxes? It's no problem with PowerShell. Get the data and export it to CSV. Or maybe you need to give a lot of users access to a SharePoint site. That's no problem with PowerShell.","inlineStyleRanges":[],"type":"unstyled","data":{},"depth":0,"key":"cabqa"},{"type":"header-two","text":"How do you access PowerShell?","data":{},"key":"6rdgp","depth":0,"inlineStyleRanges":[],"entityRanges":[]},{"data":{},"depth":0,"key":"49v","entityRanges":[],"text":"PowerShell is automatically installed on all the latest versions of Windows. To access PowerShell on your computer click in the search box then type PowerShell. Finally, click PowerShell in the start menu.","type":"unstyled","inlineStyleRanges":[]},{"entityRanges":[],"type":"unstyled","data":{},"depth":0,"key":"9k8rv","inlineStyleRanges":[],"text":""},{"entityRanges":[{"offset":0,"key":0,"length":1}],"key":"7l3he","data":{},"inlineStyleRanges":[],"type":"atomic","depth":0,"text":" "},{"type":"header-two","entityRanges":[],"key":"c61f7","inlineStyleRanges":[],"data":{},"depth":0,"text":"How to connect to Microsoft 365 using PowerShell"},{"type":"header-three","key":"8riom","data":{},"depth":0,"inlineStyleRanges":[],"text":"One time setup","entityRanges":[]},{"inlineStyleRanges":[{"offset":0,"length":77,"style":"ITALIC"}],"depth":0,"key":"aep59","type":"unstyled","entityRanges":[],"data":{},"text":"The following instructions need to be performed once per user on the machine."},{"key":"ce25g","data":{},"inlineStyleRanges":[],"depth":0,"text":"1. If you're not running Windows 10, install Microsoft Online Services Sign-in Assistant. ","type":"unstyled","entityRanges":[{"offset":45,"length":43,"key":1}]},{"text":"2. Run Windows PowerShell as an administrator by searching for PowerShell in the start menu. Right-click Windows PowerShell then click Run as administrator.","data":{},"depth":0,"type":"unstyled","entityRanges":[],"inlineStyleRanges":[{"style":"BOLD","length":10,"offset":63},{"style":"BOLD","length":18,"offset":105},{"style":"BOLD","offset":135,"length":20}],"key":"dq3u9"},{"text":" ","depth":0,"entityRanges":[{"key":2,"length":1,"offset":0}],"type":"atomic","data":{},"key":"4fp2","inlineStyleRanges":[]},{"text":"3. When prompted click Yes.","type":"unstyled","depth":0,"data":{},"inlineStyleRanges":[{"style":"BOLD","length":3,"offset":23}],"key":"3iloq","entityRanges":[]},{"inlineStyleRanges":[],"type":"atomic","entityRanges":[{"length":1,"offset":0,"key":3}],"key":"ddi9p","data":{},"depth":0,"text":" "},{"inlineStyleRanges":[{"style":"BOLD","offset":30,"length":62}],"data":{},"entityRanges":[],"depth":0,"type":"unstyled","key":"13ej6","text":"4. Run the following command: Set-PSRepository -Name \"PSGallery\" -InstallationPolicy Trusted"},{"data":{"text-align":"left"},"key":"fqqc6","entityRanges":[],"depth":0,"text":"5. If prompted with the following click Y then press Enter.","inlineStyleRanges":[{"length":59,"offset":0,"style":"color-rgb(33,37,41)"},{"offset":0,"length":59,"style":"bgcolor-rgb(255,255,255)"},{"style":"fontsize-16","length":59,"offset":0},{"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":0,"length":59},{"style":"BOLD","offset":40,"length":1},{"length":5,"offset":53,"style":"BOLD"}],"type":"unstyled"},{"inlineStyleRanges":[{"offset":0,"length":515,"style":"color-rgb(33,37,41)"},{"style":"bgcolor-rgb(255,255,255)","offset":0,"length":515},{"style":"fontsize-16","length":515,"offset":0},{"length":515,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":0},{"length":515,"offset":0,"style":"bgcolor-rgb(241,241,241)"},{"style":"fontfamily-monospace","length":515,"offset":0}],"key":"321qq","depth":0,"entityRanges":[],"text":"NuGet provider is required to continue\nPowerShellGet requires NuGet provider version '2.8.5.201' or newer to interact with NuGet-based repositories. The NuGet provider must be available in 'C:\\Program Files\\PackageManagement\\ProviderAssemblies' or 'C:\\Users\\BasicUser\\AppData\\Local\\PackageManagement\\ProviderAssemblies'. You can also install the NuGet provider by running 'Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force'. Do you want PowerShellGet to install and import the NuGet provider now?","data":{"text-align":"left"},"type":"unstyled"},{"depth":0,"data":{},"inlineStyleRanges":[],"entityRanges":[{"length":1,"offset":0,"key":4}],"key":"61qft","text":" ","type":"atomic"},{"data":{},"entityRanges":[],"key":"cf0r2","depth":0,"text":"6. Run the following command: Install-Module MSOnline","inlineStyleRanges":[{"length":23,"offset":30,"style":"BOLD"}],"type":"unstyled"},{"entityRanges":[],"type":"unstyled","inlineStyleRanges":[{"style":"color-rgb(33,37,41)","offset":3,"length":27},{"style":"bgcolor-rgb(255,255,255)","length":27,"offset":3},{"length":27,"style":"fontsize-16","offset":3},{"length":27,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":3},{"style":"BOLD","length":28,"offset":30}],"depth":0,"text":"7. Run the following command: Install-Module -Name AzureAD","key":"8pqmh","data":{}},{"inlineStyleRanges":[{"offset":3,"length":26,"style":"color-rgb(33,37,41)"},{"length":26,"offset":3,"style":"bgcolor-rgb(255,255,255)"},{"length":26,"offset":3,"style":"fontsize-16"},{"offset":3,"length":26,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji"},{"style":"BOLD","offset":30,"length":45}],"depth":0,"type":"unstyled","entityRanges":[],"text":"8. Run the following command: Install-Module -Name ExchangeOnlineManagement","data":{},"key":"esien"},{"key":"bro85","depth":0,"inlineStyleRanges":[{"length":26,"style":"color-rgb(33,37,41)","offset":3},{"style":"bgcolor-rgb(255,255,255)","offset":3,"length":26},{"length":26,"style":"fontsize-16","offset":3},{"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":3,"length":26},{"length":59,"offset":30,"style":"BOLD"}],"entityRanges":[],"data":{},"text":"9. Run the following command: Install-Module -Name Microsoft.Online.SharePoint.PowerShell","type":"unstyled"},{"text":"10. Run the following command: Install-Module -Name MicrosoftTeams -Force -AllowClobber","type":"unstyled","inlineStyleRanges":[{"offset":31,"style":"BOLD","length":56}],"data":{},"key":"84plp","depth":0,"entityRanges":[]},{"entityRanges":[{"offset":0,"key":5,"length":1}],"inlineStyleRanges":[],"type":"atomic","key":"5h5i2","text":" ","data":{},"depth":0},{"key":"5bgsg","depth":0,"inlineStyleRanges":[{"style":"color-rgb(33,37,41)","offset":4,"length":59},{"offset":4,"style":"bgcolor-rgb(255,255,255)","length":59},{"length":59,"style":"fontsize-16","offset":4},{"offset":4,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":59},{"style":"BOLD","length":32,"offset":31}],"type":"unstyled","entityRanges":[],"text":"11. Run the following command: Set-ExecutionPolicy RemoteSigned","data":{}},{"key":"6capj","type":"unstyled","entityRanges":[],"data":{},"depth":0,"inlineStyleRanges":[{"length":85,"style":"color-rgb(33,37,41)","offset":0},{"style":"bgcolor-rgb(255,255,255)","length":85,"offset":0},{"style":"fontsize-16","offset":0,"length":85},{"offset":0,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":85},{"style":"BOLD","length":1,"offset":42},{"length":5,"style":"BOLD","offset":55}],"text":"12. When prompted with the following type Y then press Enter.\nExecution Policy Change"},{"inlineStyleRanges":[{"length":290,"style":"color-rgb(33,37,41)","offset":0},{"style":"bgcolor-rgb(255,255,255)","length":290,"offset":0},{"length":290,"style":"fontsize-16","offset":0},{"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":290,"offset":0},{"offset":0,"length":290,"style":"CODE"}],"depth":0,"data":{},"entityRanges":[],"text":"The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the security risks described in the about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?","type":"unstyled","key":"3jspu"},{"text":"[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is \"N\"):","key":"12nq3","inlineStyleRanges":[{"style":"color-rgb(33,37,41)","offset":0,"length":87},{"length":87,"style":"bgcolor-rgb(255,255,255)","offset":0},{"style":"fontsize-16","offset":0,"length":87},{"offset":0,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":87},{"style":"CODE","length":87,"offset":0}],"data":{},"entityRanges":[],"type":"unstyled","depth":0},{"key":"1scq0","depth":0,"entityRanges":[],"inlineStyleRanges":[],"data":{},"text":"","type":"unstyled"},{"inlineStyleRanges":[],"depth":0,"entityRanges":[{"key":6,"length":1,"offset":0}],"type":"atomic","key":"a7pjj","data":{},"text":" "},{"inlineStyleRanges":[],"type":"unstyled","entityRanges":[],"text":"That's it. Your computer is set up to connect to Microsoft 365 using PowerShell. Now we need to connect to Microsoft 365 using PowerShell.","depth":0,"data":{},"key":"568ko"},{"data":{},"text":"Connect to Microsoft 365 using PowerShell","inlineStyleRanges":[],"depth":0,"key":"3njc8","entityRanges":[],"type":"header-three"},{"entityRanges":[],"key":"d0mni","data":{},"depth":0,"inlineStyleRanges":[],"text":"You may have noticed that we installed modules for MSOnline, Azure AD, Exchange Online, SharePoint, and Microsoft Teams. Just like the Microsoft 365 admin centers, PowerShell is separated into different modules. Depending on the task you want to perform you'll need to connect using the correct module/command. The first connection we'll make is to Office 365. The MSOnline module is used to manage users, groups, licenses, and the tenant as a whole. It's directly related to the Microsoft 365 admin center from the last lesson.","type":"unstyled"},{"key":"55jg8","type":"unstyled","data":{},"depth":0,"entityRanges":[],"inlineStyleRanges":[],"text":"The following commands will need to be run every time you want to connect to Microsoft 365 using PowerShell."},{"key":"3cfuv","data":{},"depth":0,"text":"1. Run the following command: Connect-MsolService","entityRanges":[],"inlineStyleRanges":[{"offset":30,"style":"BOLD","length":19}],"type":"unstyled"},{"depth":0,"entityRanges":[],"type":"unstyled","text":"2. When prompted enter your username then click Next.","inlineStyleRanges":[{"offset":48,"length":4,"style":"BOLD"}],"data":{},"key":"eqhcv"},{"text":" ","inlineStyleRanges":[],"key":"26a9t","data":{},"entityRanges":[{"key":7,"length":1,"offset":0}],"type":"atomic","depth":0},{"key":"6pme2","type":"unstyled","text":"3. Then enter your password and click Sign in.","data":{},"entityRanges":[],"depth":0,"inlineStyleRanges":[]},{"data":{},"inlineStyleRanges":[],"text":" ","entityRanges":[{"key":8,"offset":0,"length":1}],"depth":0,"type":"atomic","key":"52mle"},{"text":"4. If prompted for MFA, enter your MFA information then finish the connection.","data":{},"inlineStyleRanges":[],"depth":0,"key":"4igbs","type":"unstyled","entityRanges":[]},{"text":"How to learn more","key":"cvjfl","data":{},"type":"header-three","depth":0,"entityRanges":[],"inlineStyleRanges":[]},{"entityRanges":[],"key":"5p318","text":"That's all it takes to connect to Microsoft 365 using PowerShell but the question is what now? How do you get a list of the users? Or the groups? Well, you can view all of the commands available to you via the command Get-Command -Module MSOnline. You can get help on each of the commands by running \"get-help <the-command>\".","inlineStyleRanges":[{"style":"BOLD","length":28,"offset":218},{"style":"BOLD","offset":301,"length":22}],"depth":0,"type":"unstyled","data":{}},{"data":{},"key":"5c8st","depth":0,"text":"For example, there's a command available called \"Get-MsolUser\". To see the help for it you can run Get-Help Get-MsolUser.","entityRanges":[],"inlineStyleRanges":[{"length":21,"style":"BOLD","offset":99}],"type":"unstyled"},{"text":" ","entityRanges":[{"offset":0,"length":1,"key":9}],"data":{},"key":"cipd2","inlineStyleRanges":[],"depth":0,"type":"atomic"},{"data":{},"entityRanges":[],"depth":0,"inlineStyleRanges":[{"offset":55,"style":"BOLD","length":32}],"type":"unstyled","text":"To see an example of running the commands you can run \"Get-Help <the-command> -Examples\"","key":"8vj4m"},{"text":" ","entityRanges":[{"length":1,"key":10,"offset":0}],"type":"atomic","data":{},"inlineStyleRanges":[],"depth":0,"key":"b06n5"},{"type":"unstyled","entityRanges":[],"inlineStyleRanges":[],"text":"If you need further help simply Google it.","key":"qs6l","depth":0,"data":{}},{"data":{},"key":"1ljp3","type":"header-three","depth":0,"entityRanges":[],"inlineStyleRanges":[],"text":"Connect to Exchange Online using PowerShell"},{"text":"So now you've connected to Office 365, but you can't manage email from the Microsoft 365 PowerShell. To manage the email you need to connect to Exchange Online.","data":{},"type":"unstyled","entityRanges":[],"depth":0,"inlineStyleRanges":[],"key":"4kjr2"},{"entityRanges":[],"text":"1. From PowerShell run the following command: Connect-ExchangeOnline","depth":0,"inlineStyleRanges":[{"style":"BOLD","length":22,"offset":46}],"key":"d0ueq","data":{},"type":"unstyled"},{"key":"cjutf","inlineStyleRanges":[],"type":"unstyled","depth":0,"data":{},"entityRanges":[],"text":"2. Enter your username and password like you did when connecting to Microsoft 365."},{"depth":0,"entityRanges":[{"length":24,"offset":258,"key":11}],"type":"unstyled","key":"12pah","data":{},"inlineStyleRanges":[{"offset":106,"length":44,"style":"BOLD"}],"text":"That's it. You're now connected to Exchange Online using PowerShell. Just like Microsoft 365, you can run Get-Command -Module ExchangeOnlineManagement to get the primary commands but there are a lot more not listed. You can view all the commands by going to Exchange Online Commands."},{"inlineStyleRanges":[],"depth":0,"text":"Running a command","key":"7fbtf","data":{},"type":"header-four","entityRanges":[]},{"data":{},"entityRanges":[],"inlineStyleRanges":[{"style":"color-rgb(33,37,41)","length":183,"offset":123},{"length":183,"offset":123,"style":"bgcolor-rgb(255,255,255)"},{"offset":123,"length":183,"style":"fontsize-16"},{"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":123,"length":183},{"style":"BOLD","length":49,"offset":310}],"depth":0,"text":"So here's an example command: Set-Mailbox. You can use the set-mailbox command to edit the settings of existing mailboxes. Hypothetically, let's say someone deleted emails in User1's mailbox and you check the audit logs but they are empty. What do you do? You enable auditing for User1's mailbox. How? you run Set-Mailbox -Identity \"User1\" -AuditEnabled $true. Simply replace User1 with the user you want to enable auditing for and you're good to go.","key":"fkqm6","type":"unstyled"},{"text":"Here's another example: let's say yesterday you created retention labels so users can flag emails with a label to retain the emails permanently but a user needs to use the new label today what do you do? Run Get-Mailbox -ResultSize unlimited -RecipientTypeDetails UserMailbox | %{ Start-ManagedFolderAssistant $_.UserPrincipalName }.","key":"28voh","depth":0,"data":{},"entityRanges":[],"type":"unstyled","inlineStyleRanges":[{"length":124,"style":"BOLD","offset":208}]},{"inlineStyleRanges":[],"entityRanges":[],"key":"a86dm","type":"header-three","text":"Connect to Azure AD using PowerShell","depth":0,"data":{}},{"inlineStyleRanges":[],"text":"Excellent, now we are connecting to Microsoft 365 and Exchange Online. But what about Azure AD? It's just as easy.","type":"unstyled","key":"be1u5","entityRanges":[],"depth":0,"data":{}},{"type":"unstyled","text":"1. From PowerShell run the following command: Connect-AzureAD","data":{},"key":"6slku","inlineStyleRanges":[{"style":"BOLD","offset":46,"length":15}],"depth":0,"entityRanges":[]},{"key":"9p3cf","depth":0,"type":"unstyled","entityRanges":[],"data":{},"inlineStyleRanges":[],"text":"2. Enter your username and password like you did when connecting to Microsoft 365."},{"depth":0,"data":{},"type":"unstyled","entityRanges":[],"key":"eo0ft","inlineStyleRanges":[{"style":"BOLD","offset":74,"length":27}],"text":"That's it. You're now connected to Azure AD using PowerShell. You can run Get-Command -Module AzureAD to get the commands for Azure AD."},{"text":"Connect to Security & Compliance center using PowerShell","depth":0,"key":"4auja","data":{},"inlineStyleRanges":[],"type":"header-three","entityRanges":[]},{"entityRanges":[],"type":"unstyled","data":{},"key":"9aj05","inlineStyleRanges":[{"style":"BOLD","length":19,"offset":46}],"text":"1. From PowerShell run the following command: Connect-IPPSSession","depth":0},{"data":{},"entityRanges":[],"type":"unstyled","depth":0,"text":"2. Enter your username and password like you did when connecting to Microsoft 365.","inlineStyleRanges":[],"key":"f6knf"},{"data":{},"text":"That's it. You're now connected to Security & Compliance using PowerShell. You can view the commands by going to Security & Compliance Center PowerShell commands.","depth":0,"entityRanges":[{"key":12,"offset":113,"length":48}],"type":"unstyled","inlineStyleRanges":[],"key":"c0rv7"},{"key":"4ulvn","text":"Here's a more complex example of using PowerShell. From the Security & Compliance admin center, you can download an XML of the rules, update the XML, then upload the XML to modify the rules.","inlineStyleRanges":[],"entityRanges":[],"depth":0,"type":"unstyled","data":{}},{"key":"19l8l","data":{},"text":"1. Run Connect-IPPSession to connect to the security and compliance PowerShell","inlineStyleRanges":[],"depth":0,"type":"unstyled","entityRanges":[]},{"text":"2. Export the XML file of the current rules using the following:","entityRanges":[],"data":{},"depth":0,"type":"unstyled","key":"cgfd8","inlineStyleRanges":[]},{"entityRanges":[],"inlineStyleRanges":[{"length":61,"offset":0,"style":"CODE"}],"data":{},"text":"$ruleCollections = Get-DlpSensitiveInformationTypeRulePackage","type":"unstyled","depth":0,"key":"c0732"},{"inlineStyleRanges":[{"style":"CODE","offset":0,"length":127}],"type":"unstyled","depth":0,"text":"Set-Content -path C:\\custompath\\exportedRules.xml -Encoding Byte -Value $ruleCollections.SerializedClassificationRuleCollection","data":{},"key":"8mber","entityRanges":[]},{"key":"qur6","text":"3. Modify the exported XML.","type":"unstyled","depth":0,"inlineStyleRanges":[{"style":"color-rgb(33,37,41)","offset":0,"length":27},{"style":"bgcolor-rgb(255,255,255)","length":27,"offset":0},{"length":27,"offset":0,"style":"fontsize-16"},{"offset":0,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":27}],"data":{},"entityRanges":[]},{"entityRanges":[],"type":"unstyled","text":"4. Upload your new rules","key":"b5374","depth":0,"data":{},"inlineStyleRanges":[{"style":"color-rgb(33,37,41)","offset":0,"length":24},{"style":"bgcolor-rgb(255,255,255)","length":24,"offset":0},{"length":24,"style":"fontsize-16","offset":0},{"length":24,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":0}]},{"text":"New-DlpSensitiveInformationTypeRulePackage -FileData (Get-Content -Path \"C:\\custompath\\exportedRules.xml\" -Encoding Byte)","inlineStyleRanges":[{"length":121,"style":"color-rgb(33,37,41)","offset":0},{"style":"bgcolor-rgb(255,255,255)","length":87,"offset":0},{"style":"bgcolor-rgb(255,255,255)","length":21,"offset":100},{"length":121,"style":"fontsize-16","offset":0},{"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":87,"offset":0},{"offset":100,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":21},{"length":87,"offset":0,"style":"CODE"},{"style":"CODE","offset":100,"length":21},{"style":"bgcolor-rgb(241,241,241)","offset":87,"length":13},{"style":"fontfamily-monospace","offset":87,"length":13}],"data":{},"entityRanges":[],"depth":0,"key":"9v1eo","type":"unstyled"},{"type":"unstyled","data":{},"inlineStyleRanges":[{"length":41,"offset":0,"style":"color-rgb(33,37,41)"},{"offset":0,"length":41,"style":"bgcolor-rgb(255,255,255)"},{"length":41,"style":"fontsize-16","offset":0},{"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","length":41,"offset":0},{"offset":17,"length":1,"style":"BOLD"},{"length":5,"offset":35,"style":"BOLD"}],"entityRanges":[],"depth":0,"key":"9ts77","text":"To confirm, type Y, and then press Enter."},{"depth":0,"inlineStyleRanges":[],"key":"46e7t","text":"Connect to SharePoint Online using PowerShell","entityRanges":[],"data":{},"type":"header-three"},{"data":{},"inlineStyleRanges":[],"type":"unstyled","text":"Connecting to SharePoint Online using PowerShell takes a couple of extra steps. It isn't difficult, you just need to grab another piece of information.","key":"1l4fv","depth":0,"entityRanges":[]},{"text":"1. Go to https://admin.microsoft.com/Adminportal/Home?source=applauncher#/alladmincenters and login to your Office 365 tenant using the global admin credentials.","inlineStyleRanges":[],"entityRanges":[{"length":80,"offset":9,"key":13}],"key":"4a0n2","depth":0,"data":{},"type":"unstyled"},{"entityRanges":[],"depth":0,"data":{},"inlineStyleRanges":[{"length":10,"offset":9,"style":"BOLD"}],"text":"2. Click SharePoint in the list.","type":"unstyled","key":"cad8p"},{"entityRanges":[{"length":1,"offset":0,"key":14}],"text":" ","depth":0,"key":"6d15e","inlineStyleRanges":[],"type":"atomic","data":{}},{"key":"5pltk","entityRanges":[],"data":{},"type":"unstyled","inlineStyleRanges":[],"depth":0,"text":"3. Copy the SharePoint URL. Everything before the _layouts."},{"type":"atomic","depth":0,"data":{},"text":" ","inlineStyleRanges":[],"entityRanges":[{"length":1,"offset":0,"key":15}],"key":"c18k3"},{"key":"68hp3","inlineStyleRanges":[{"style":"BOLD","offset":29,"length":44}],"entityRanges":[],"text":"4. Run the following command Connect-SPOService -Url <The URL you copied> replacing the <The URL you copied> with the URL you copied in step 3.","type":"unstyled","data":{},"depth":0},{"depth":0,"data":{},"key":"escub","text":" ","type":"atomic","entityRanges":[{"key":16,"offset":0,"length":1}],"inlineStyleRanges":[]},{"key":"8rjca","depth":0,"type":"unstyled","data":{},"inlineStyleRanges":[],"entityRanges":[],"text":"5. Login with your admin credentials."},{"text":"That's it. You're now connected to SharePoint Online using PowerShell. To view the commands run Get-Command -Module Microsoft.Online.SharePoint.PowerShell.","data":{},"inlineStyleRanges":[{"length":58,"style":"BOLD","offset":96}],"type":"unstyled","key":"dvgfp","entityRanges":[],"depth":0},{"data":{},"key":"9fbit","entityRanges":[],"inlineStyleRanges":[{"length":40,"offset":131,"style":"color-rgb(33,37,41)"},{"offset":131,"length":40,"style":"bgcolor-rgb(255,255,255)"},{"length":40,"style":"fontsize-16","offset":131},{"length":40,"style":"fontfamily-system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji","offset":131},{"style":"BOLD","length":57,"offset":437}],"type":"unstyled","depth":0,"text":"Let's take another example command. Let's say you're tasked with securing your SharePoint environment. You need to stop users from downloading, printing, and syncing files from SharePoint Online using unmanaged devices. What's a managed device? A managed device is a device that is hybrid Azure AD joined or compliant in Intune. In short, a user has logged in to your SharePoint environment using their device. How do you do it? You run Set-SPOTenant -ConditionalAccessPolicy AllowLimitedAccess. Let's break down the command. The Set-SPOTenant portion is the command. It's run to set properties on the SharePoint Online organization."},{"key":"1d8h1","data":{},"entityRanges":[],"type":"header-three","text":"Connect to Microsoft Teams using PowerShell","inlineStyleRanges":[],"depth":0},{"depth":0,"data":{},"type":"unstyled","entityRanges":[],"inlineStyleRanges":[],"key":"9ah0p","text":"Excellent, now we are connecting to Microsoft 365, Exchage Online, Azure AD, SharePoint Online, and Security & Compliance center. But what about Microsoft Teams? It's just as easy."},{"entityRanges":[],"data":{},"type":"unstyled","key":"fqh1o","depth":0,"inlineStyleRanges":[{"offset":46,"length":22,"style":"BOLD"}],"text":"1. From PowerShell run the following command: Connect-MicrosoftTeams"},{"inlineStyleRanges":[],"depth":0,"data":{},"key":"9t1pg","type":"unstyled","entityRanges":[],"text":"2. Enter your username and password like you did when connecting to Microsoft 365."},{"data":{},"text":"That's it. You're now connected to Microsoft Teams using PowerShell. You can run Get-Command -Module MicrosoftTeams to get the commands for Microsoft Teams.","type":"unstyled","entityRanges":[],"inlineStyleRanges":[{"offset":81,"style":"BOLD","length":34}],"key":"b7mb5","depth":0},{"key":"5043i","data":{},"type":"header-three","inlineStyleRanges":[],"entityRanges":[],"depth":0,"text":"To Disconnect from Microsoft 365 using PowerShell"},{"key":"fc7dg","data":{},"entityRanges":[],"inlineStyleRanges":[],"text":"To disconnect from Microsoft 365 PowerShell simply close the PowerShell window. You can simply close the window to disconnect from all the PowerShell connections.","type":"unstyled","depth":0},{"key":"350kf","text":"To disconnect from Exchange Online or Security and Compliance PowerShell run the following command: Disconnect-ExchangeOnline","data":{},"type":"unstyled","entityRanges":[],"inlineStyleRanges":[{"style":"BOLD","offset":100,"length":25}],"depth":0},{"text":"To disconnect from Azure AD PowerShell run the following command: Disconnect-AzureAD","depth":0,"inlineStyleRanges":[{"offset":66,"style":"BOLD","length":18}],"data":{},"key":"4dd90","entityRanges":[],"type":"unstyled"},{"data":{},"type":"unstyled","depth":0,"text":"To disconnect from SharePoint Online PowerShell run the following command: Disconnect-SPOService","inlineStyleRanges":[{"offset":75,"length":21,"style":"BOLD"}],"key":"a6pvn","entityRanges":[]},{"entityRanges":[],"key":"bub1","inlineStyleRanges":[{"offset":73,"length":25,"style":"BOLD"}],"type":"unstyled","data":{},"depth":0,"text":"To disconnect from Microsoft Teams PowerShell run the following command: Disconnect-MicrosoftTeams"}]},"publish":true,"featuredImage":"https://i.ibb.co/HV13YF6/install-microsoft-365-powershell-modules.png","datePublished":"2022/5/26","type":"article","sectionId":"qwJW5VrBW","images":["https://i.ibb.co/31fXgzV/Power-Shell.png","https://i.ibb.co/4WfH7pW/powershell-as-admin.png","https://i.ibb.co/tYJ6H9X/Power-Shell-Allow-this-app.png","https://i.ibb.co/27KmRNQ/Power-Shell-Approval.png","https://i.ibb.co/Qf5V2PF/install-module-azure.png","https://i.ibb.co/qyMttBg/install-nuget.png","https://i.ibb.co/HV13YF6/install-microsoft-365-powershell-modules.png","https://i.ibb.co/hdMWybz/connect-to-microsoft-365.png","https://i.ibb.co/0VgpjZ3/connect-to-microsoft-365-enter-password.png","https://i.ibb.co/4Rs6bkV/get-help-get-msoluser.png","https://i.ibb.co/HdW0MVN/get-help-get-msoluser-examples.png","https://i.ibb.co/1mnGG2H/set-executionpolicy.png","https://i.ibb.co/xMS0rB1/sharepoint-admin-center.png","https://i.ibb.co/BKbHN2x/Share-Point-url.png","https://i.ibb.co/pPgzDsj/connect-to-sharepoint-online-using-powershell.png"],"slug":"Managing-Microsoft-365-through-PowerShell-cg_vxOX9L","title":"Managing Microsoft 365 through PowerShell"},
      articles: [{"id":"cpchjBLkC","sectionId":"qwJW5VrBW","slug":"Whats-in-this-course-cpchjBLkC","title":"What's in this course?","featuredImage":"https://i.ibb.co/zFs9Vfb/microsoft365-security-administrator-associate-600x600.png"},{"id":"KKkBOVuS4","sectionId":"qwJW5VrBW","slug":"Creating-a-free-Microsoft-365-tenant-for-practice-KKkBOVuS4","title":"Creating a free Microsoft 365 tenant for practice","featuredImage":"https://i.ibb.co/F07sjQJ/microsoft-365-e5-trial.png"},{"id":"bzotoOjEe","sectionId":"qwJW5VrBW","slug":"Managing-the-Microsoft-365-tenant-Introduction-to-the-admin-centers-bzotoOjEe","title":"Managing the Microsoft 365 tenant - Introduction to the admin centers","featuredImage":"https://i.ibb.co/f1cr4zt/Microsoft-365-admin-centers.png"},{"id":"cg_vxOX9L","sectionId":"qwJW5VrBW","slug":"Managing-Microsoft-365-through-PowerShell-cg_vxOX9L","title":"Managing Microsoft 365 through PowerShell","featuredImage":"https://i.ibb.co/HV13YF6/install-microsoft-365-powershell-modules.png"},{"id":"uYCIPbnMC","sectionId":"AFV_acckJ","slug":"How-to-create-users-in-Microsoft-365-Cloud-Only-uYCIPbnMC","title":"How to create users in Microsoft 365 Cloud Only","featuredImage":"https://i.ibb.co/Wnt5Q43/View-Microsoft-365-Users.png"},{"id":"7CpqFkPZU","sectionId":"AFV_acckJ","slug":"Creating-and-managing-admins-through-roles-7CpqFkPZU","title":"Creating and managing admins through roles","featuredImage":"https://i.ibb.co/kySL4HQ/Roles-and-administrators.png"},{"id":"rZzausKJ1","sectionId":"AFV_acckJ","slug":"Time-limited-admin-roles-in-Microsoft-365-rZzausKJ1","title":"Time limited admin roles in Microsoft 365","featuredImage":"https://i.ibb.co/nDvjyPD/select-member-to-add-to-PIM-role.png"},{"id":"ky5W0Lz5P","sectionId":"AFV_acckJ","slug":"Whats-AD-Connect-ky5W0Lz5P","title":"What's AD Connect","featuredImage":"https://i.ibb.co/7nDqr9x/Whats-AD-Connect.png"},{"id":"i9pJIjTNH","sectionId":"AFV_acckJ","slug":"Protecting-Passwords-in-Microsoft-365-i9pJIjTNH","title":"Protecting Passwords in Microsoft 365","featuredImage":"https://i.ibb.co/DLD4G4q/access-smart-lockout-settings.png"},{"id":"S1hQgFOMV","sectionId":"AFV_acckJ","slug":"Creating-and-managing-users-through-groups-S1hQgFOMV","title":"Creating and managing users through groups","featuredImage":"https://i.ibb.co/nmmC28M/add-a-group-microsoft-365.png"},{"id":"2QfoI2HxY","sectionId":"AFV_acckJ","slug":"Securing-and-implementing-enterprise-applications-2QfoI2HxY","title":"Securing and implementing enterprise applications","featuredImage":"https://i.ibb.co/C2mp69m/disable-user-consent.png"},{"id":"V1en9Iugh","sectionId":"AFV_acckJ","slug":"Whats-a-conditional-access-policy-V1en9Iugh","title":"What's a conditional access policy?","featuredImage":"https://i.ibb.co/DQm1sY0/Create-conditional-access-policy.png"},{"id":"nAAIvNbtk","sectionId":"AFV_acckJ","slug":"The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk","title":"The many ways to implement multi-factor authentication (MFA) in Microsoft 365","featuredImage":"https://i.ibb.co/P1P0wNY/microsoft-365-manage-security-defaults.png"},{"id":"2S9jn0aLr","sectionId":"AFV_acckJ","slug":"Implement-Self-service-password-reset-in-Microsoft-365-2S9jn0aLr","title":"Implement Self-service password reset in Microsoft 365","featuredImage":"https://i.ibb.co/58y9JVg/write-back-passwords-to-on-premises-directory.png"},{"id":"FldNualGC","sectionId":"AFV_acckJ","slug":"Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC","title":"Locking down your Microsoft 365 tenant from Microsoft engineers","featuredImage":"https://i.ibb.co/DCmpnT9/Enable-Customer-Lockbox.png"},{"id":"NFQ6rYFeQ","sectionId":"AFV_acckJ","slug":"Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ","title":"Implementing intelligent security using risk policies in Microsoft 365","featuredImage":"https://i.ibb.co/0cyQJ7j/Risk-Detections.png"},{"id":"rK48f6iM2","sectionId":"AFV_acckJ","slug":"Automating-Access-Review-in-Microsoft-365-rK48f6iM2","title":"Automating Access Review in Microsoft 365","featuredImage":"https://i.ibb.co/Xsxvz6Z/new-access-review.png"},{"id":"RHW1API2s","sectionId":"AFV_acckJ","slug":"Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s","title":"Just in time, approval and notification for admin roles in Microsoft 365","featuredImage":"https://i.ibb.co/dcb6XFN/Activate-a-Role.png"},{"id":"z8EMM9Eu_","sectionId":"QScYfSu74","slug":"Whats-Microsoft-365-Defender-z8EMM9Eu_","title":"What's Microsoft 365 Defender?","featuredImage":"https://i.ibb.co/MDMyDQt/Microsoft-Defender.png"},{"id":"Kye_yNLxA","sectionId":"QScYfSu74","slug":"Whats-Microsoft-Defender-for-identity-Kye_yNLxA","title":"What's Microsoft Defender for identity?","featuredImage":"https://i.ibb.co/bQDBh0Y/Defender-for-Identity-Timeline.png"},{"id":"EnPyp7ukN","sectionId":"QScYfSu74","slug":"Whats-Microsoft-Defender-for-Office-365-EnPyp7ukN","title":"What's Microsoft Defender for Office 365?","featuredImage":"https://i.ibb.co/WcwKY2G/Microsoft-365-incidents-and-alerts.png"},{"id":"6HUOr7qbL","sectionId":"QScYfSu74","slug":"Protect-your-email-environment-from-malicious-actors-6HUOr7qbL","title":"Protect your email and Office environment from malicious actors","featuredImage":"https://i.ibb.co/Df0KQVp/Reports.png"},{"id":"GCOOUsSBT","sectionId":"QScYfSu74","slug":"Protecting-email-against-phishing-attacks-GCOOUsSBT","title":"Protecting email against phishing attacks","featuredImage":"https://i.ibb.co/GCjZHWg/edit-actions.png"},{"id":"GG4cMY8pK","sectionId":"QScYfSu74","slug":"Simulating-attacks-with-Microsoft-365-GG4cMY8pK","title":"Simulating attacks with Microsoft 365","featuredImage":"https://i.ibb.co/NyvnbMK/simulation-overview-view-users-circled.png"},{"id":"z0qPG6v4T","sectionId":"QScYfSu74","slug":"Protecting-Windows-10-and-other-devices-with-Microsoft-Defender-for-Endpoint-z0qPG6v4T","title":"Protecting Windows 10 and other devices with Microsoft Defender for Endpoint","featuredImage":"https://i.ibb.co/T47Xhyh/enable-endpoint-connections.png"},{"id":"LEyZMWBSt","sectionId":"QScYfSu74","slug":"Collect-detect-investigate-and-respond-to-security-threats-using-Microsoft-Sentinel-LEyZMWBSt","title":"Collect, detect, investigate, and respond to security threats using Microsoft Sentinel","featuredImage":"https://i.ibb.co/qN9XsKj/Add-Workbook.png"},{"id":"7MQ3wE4wP","sectionId":"QScYfSu74","slug":"Implement-and-manage-Microsoft-Defender-for-Cloud-Apps-7MQ3wE4wP","title":"Implement and manage Microsoft Defender for Cloud Apps","featuredImage":"https://i.ibb.co/7g7LvFg/office-365-cloud-apps-settings.png"},{"id":"sH_Ee1DW1","sectionId":"QScYfSu74","slug":"Auditing-sign-ins-and-other-actions-in-Microsoft-365-sH_Ee1DW1","title":"Auditing sign-ins and other actions in Microsoft 365","featuredImage":"https://i.ibb.co/BqMw3jZ/Start-recording-user-and-admin-activity.png"},{"id":"vLweLmxZf","sectionId":"YhftdGIRX","slug":"How-to-classify-data-using-labels-in-Microsoft-365-vLweLmxZf","title":"How to classify data using labels in Microsoft 365","featuredImage":"https://i.ibb.co/k9nhWS5/Choose-protection-settings-for-files-and-emails.png"},{"id":"NsF7No40f","sectionId":"YhftdGIRX","slug":"Creating-and-managing-data-retention-to-conform-to-compliance-NsF7No40f","title":"Creating and managing data retention to conform to compliance","featuredImage":"https://i.ibb.co/yqC0ZdY/New-Retention-Policy.png"},{"id":"IsPGsme8w","sectionId":"YhftdGIRX","slug":"Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w","title":"Preventing accidental and malicious data loss with DLP policies","featuredImage":"https://i.ibb.co/n8WcqKM/Create-a-DLP-policy.png"},{"id":"wv2PbXnhI","sectionId":"YhftdGIRX","slug":"Everything-you-need-to-know-about-securing-SharePoint-Online-for-the-MS-500-wv2PbXnhI","title":"Everything you need to know about securing SharePoint Online for the MS-500","featuredImage":"https://i.ibb.co/Gk9NjSH/Share-Point-Online-Warning.png"},{"id":"7gR3L122b","sectionId":"l0DxUuonW","slug":"Introduction-to-Intune-7gR3L122b","title":"Introduction to Intune","featuredImage":"https://i.ibb.co/Fq3N8BX/Endpoint-Manager-Admin-Center.png"},{"id":"ZyKX3Idjs","sectionId":"l0DxUuonW","slug":"Setting-up-Android-Devices-ZyKX3Idjs","title":"Setting up Android Devices","featuredImage":"https://i.ibb.co/m0BYhL2/Connect-Intune-to-Google-Play.png"},{"id":"MAjW0a2_p","sectionId":"l0DxUuonW","slug":"Setting-up-Apple--iOS-devices-in-Intune-MAjW0a2_p","title":"Setting up Apple / iOS devices in Intune","featuredImage":"https://i.ibb.co/X7Ffb2B/Setup-Apple-Enrollment-in-Intune.png"},{"id":"XFXu2zIS9","sectionId":"l0DxUuonW","slug":"Setting-up-Windows-10-devices-in-Intune-XFXu2zIS9","title":"Setting up Windows 10 devices in Intune","featuredImage":"https://i.ibb.co/WDXKVjW/configure-device-options.png"},{"id":"_LL9VqGZO","sectionId":"l0DxUuonW","slug":"How-to-manage-devices-using-Intune-_LL9VqGZO","title":"How to manage devices using Intune","featuredImage":"https://i.ibb.co/HPQ2m8t/Create-an-endpoint-protection-profile.png"},{"id":"qDRA4jjoN","sectionId":"l0DxUuonW","slug":"Understanding-compliance-policies-qDRA4jjoN","title":"Understanding compliance policies","featuredImage":"https://i.ibb.co/N3Qk57v/Create-a-compliance-policy.png"},{"id":"62t_7oiZx","sectionId":"l0DxUuonW","slug":"Restricting-and-managing-apps-on-user-devices-62t_7oiZx","title":"Restricting and managing apps on user devices","featuredImage":"https://i.ibb.co/PCVRKDf/Add-an-Android-app-to-Intune.png"}],
      articleHtml: `<h2>What's PowerShell?</h2>
<p>The best way to explain PowerShell is directly from Microsoft:</p>
<blockquote>PowerShell is a cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework. PowerShell runs on Windows, Linux, and macOS.</blockquote>
<p>To put it another way, PowerShell is a command-line + a scripting language combined. It's a powerful tool that can be used to automate actions on your computer as well as actions in Microsoft 365. But it doesn't manage Microsoft 365 out of the box. You first have to extend it which can be done using modules.</p>
<h2>Why PowerShell?</h2>
<p>From PowerShell, you can make changes in bulk. For example, you can connect to Microsoft 365 using PowerShell, get a list of unlicensed users and license them all. All from a single script. You can also export data. Need a list of all the users or all the mailboxes? It's no problem with PowerShell. Get the data and export it to CSV. Or maybe you need to give a lot of users access to a SharePoint site. That's no problem with PowerShell.</p>
<h2>How do you access PowerShell?</h2>
<p>PowerShell is automatically installed on all the latest versions of Windows. To access PowerShell on your computer click in the search box then type PowerShell. Finally, click PowerShell in the start menu.</p>
<p></p>
<div style="text-align:none;"><img src="https://i.ibb.co/31fXgzV/Power-Shell.png" alt="Access PowerShell" style="height: auto;width: auto"/></div>
<h2>How to connect to Microsoft 365 using PowerShell</h2>
<h3>One time setup</h3>
<p><em>The following instructions need to be performed once per user on the machine.</em></p>
<p>1. If you're not running Windows 10, install <a href="https://download.microsoft.com/download/7/1/E/71EF1D05-A42C-4A1F-8162-96494B5E615C/msoidcli_32bit.msi" target="_blank">Microsoft Online Services Sign-in Assistant</a>.&nbsp;</p>
<p>2. Run Windows PowerShell as an administrator by searching for <strong>PowerShell</strong> in the start menu. Right-click <strong>Windows PowerShell</strong> then click <strong>Run as administrator</strong>.</p>
<img src="https://i.ibb.co/4WfH7pW/powershell-as-admin.png" alt="Open PowerShell as an admin" style="height: auto;width: auto"/>
<p>3. When prompted click <strong>Yes</strong>.</p>
<img src="https://i.ibb.co/tYJ6H9X/Power-Shell-Allow-this-app.png" alt="PowerShell Allow open as admin" style="height: auto;width: auto"/>
<p>4. Run the following command: <strong>Set-PSRepository -Name "PSGallery" -InstallationPolicy Trusted</strong></p>
<p style="text-align:left;"><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">5. If prompted with the following click <strong>Y</strong> then press <strong>Enter</strong>.</span></p>
<p style="text-align:left;"><span style="color: rgb(33,37,41);background-color: rgb(241,241,241);font-size: 16px;font-family: monospace;">NuGet provider is required to continue<br>PowerShellGet requires NuGet provider version '2.8.5.201' or newer to interact with NuGet-based repositories. The NuGet provider must be available in 'C:\\Program Files\\PackageManagement\\ProviderAssemblies' or 'C:\\Users\\BasicUser\\AppData\\Local\\PackageManagement\\ProviderAssemblies'. You can also install the NuGet provider by running 'Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force'. Do you want PowerShellGet to install and import the NuGet provider now?</span></p>
<img src="https://i.ibb.co/qyMttBg/install-nuget.png" alt="Install NuGet" style="height: auto;width: auto"/>
<p>6. Run the following command: <strong>Install-Module MSOnline</strong></p>
<p>7. <span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">Run the following command: </span><strong>Install-Module -Name AzureAD</strong></p>
<p>8. <span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">Run the following command:</span> <strong>Install-Module -Name ExchangeOnlineManagement</strong></p>
<p>9. <span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">Run the following command:</span> <strong>Install-Module -Name Microsoft.Online.SharePoint.PowerShell</strong></p>
<p>10. Run the following command: <strong>Install-Module -Name MicrosoftTeams -Force -AllowClobber</strong></p>
<img src="https://i.ibb.co/HV13YF6/install-microsoft-365-powershell-modules.png" alt="Install Microsoft 365 PowerShell Modules" style="height: auto;width: auto"/>
<p>11. <span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">Run the following command: <strong>Set-ExecutionPolicy RemoteSigned</strong></span></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">12. When prompted with the following type <strong>Y</strong> then press <strong>Enter</strong>.<br>Execution Policy Change</span></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;"><code>The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the security risks described in the about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?</code></span></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;"><code>[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "N"):</code></span></p>
<p></p>
<img src="https://i.ibb.co/1mnGG2H/set-executionpolicy.png" alt="Set-ExecutionPolicy RemoteSigned" style="height: auto;width: auto"/>
<p>That's it. Your computer is set up to connect to Microsoft 365 using PowerShell. Now we need to connect to Microsoft 365 using PowerShell.</p>
<h3>Connect to Microsoft 365 using PowerShell</h3>
<p>You may have noticed that we installed modules for MSOnline, Azure AD, Exchange Online, SharePoint, and Microsoft Teams. Just like the Microsoft 365 admin centers, PowerShell is separated into different modules. Depending on the task you want to perform you'll need to connect using the correct module/command. The first connection we'll make is to Office 365. The MSOnline module is used to manage users, groups, licenses, and the tenant as a whole. It's directly related to the Microsoft 365 admin center from the last lesson.</p>
<p>The following commands will need to be run every time you want to connect to Microsoft 365 using PowerShell.</p>
<p>1. Run the following command: <strong>Connect-MsolService</strong></p>
<p>2. When prompted enter your username then click <strong>Next</strong>.</p>
<img src="https://i.ibb.co/hdMWybz/connect-to-microsoft-365.png" alt="Connect to Microsoft 365 PowerShell - Enter Username" style="height: auto;width: auto"/>
<p>3. Then enter your password and click Sign in.</p>
<img src="https://i.ibb.co/0VgpjZ3/connect-to-microsoft-365-enter-password.png" alt="Microsoft 365 PowerShell Sign in Enter Password" style="height: auto;width: auto"/>
<p>4. If prompted for MFA, enter your MFA information then finish the connection.</p>
<h3>How to learn more</h3>
<p>That's all it takes to connect to Microsoft 365 using PowerShell but the question is what now? How do you get a list of the users? Or the groups? Well, you can view all of the commands available to you via the command <strong>Get-Command -Module MSOnline</strong>. You can get help on each of the commands by running "<strong>get-help &lt;the-command&gt;</strong>".</p>
<p>For example, there's a command available called "Get-MsolUser". To see the help for it you can run <strong>Get-Help Get-MsolUser</strong>.</p>
<img src="https://i.ibb.co/4Rs6bkV/get-help-get-msoluser.png" alt="P{owerShell command Get-Help Get-MsolUser" style="height: auto;width: auto"/>
<p>To see an example of running the commands you can run "<strong>Get-Help &lt;the-command&gt; -Examples</strong>"</p>
<img src="https://i.ibb.co/HdW0MVN/get-help-get-msoluser-examples.png" alt="PowerShell running Get-Help Get-MsolUser -Example" style="height: auto;width: auto"/>
<p>If you need further help simply Google it.</p>
<h3>Connect to Exchange Online using PowerShell</h3>
<p>So now you've connected to Office 365, but you can't manage email from the Microsoft 365 PowerShell. To manage the email you need to connect to Exchange Online.</p>
<p>1. From PowerShell run the following command: <strong>Connect-ExchangeOnline</strong></p>
<p>2. Enter your username and password like you did when connecting to Microsoft 365.</p>
<p>That's it. You're now connected to Exchange Online using PowerShell. Just like Microsoft 365, you can run <strong>Get-Command -Module ExchangeOnlineManagement</strong> to get the primary commands but there are a lot more not listed. You can view all the commands by going to <a href="https://gitbit-my.sharepoint.com/:x:/g/personal/john_gruber_gitbit_org/EQ0d0msWFOtGjxpFbMfgqd8Bk8BUclseahXPgO4dB4ZKcw?e=XB4FQq" target="_blank">Exchange Online Commands</a>.</p>
<h4>Running a command</h4>
<p>So here's an example command: Set-Mailbox. You can use the set-mailbox command to edit the settings of existing mailboxes. <span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">Hypothetically, let's say someone deleted emails in User1's mailbox and you check the audit logs but they are empty. What do you do? You enable auditing for User1's mailbox. How? you </span>run <strong>Set-Mailbox -Identity "User1" -AuditEnabled $true</strong>. Simply replace User1 with the user you want to enable auditing for and you're good to go.</p>
<p>Here's another example: let's say yesterday you created retention labels so users can flag emails with a label to retain the emails permanently but a user needs to use the new label today what do you do? Run <strong>Get-Mailbox -ResultSize unlimited -RecipientTypeDetails UserMailbox | %{ Start-ManagedFolderAssistant $_.UserPrincipalName }</strong>.</p>
<h3>Connect to Azure AD using PowerShell</h3>
<p>Excellent, now we are connecting to Microsoft 365 and Exchange Online. But what about Azure AD? It's just as easy.</p>
<p>1. From PowerShell run the following command: <strong>Connect-AzureAD</strong></p>
<p>2. Enter your username and password like you did when connecting to Microsoft 365.</p>
<p>That's it. You're now connected to Azure AD using PowerShell. You can run <strong>Get-Command -Module AzureAD</strong> to get the commands for Azure AD.</p>
<h3>Connect to Security &amp; Compliance center using PowerShell</h3>
<p>1. From PowerShell run the following command: <strong>Connect-IPPSSession</strong></p>
<p>2. Enter your username and password like you did when connecting to Microsoft 365.</p>
<p>That's it. You're now connected to Security &amp; Compliance using PowerShell. You can view the commands by going to <a href="https://gitbit-my.sharepoint.com/:x:/g/personal/john_gruber_gitbit_org/EQwm_H3-5SFOkqV8qvhklBQB225Fdz4GfV1grM-6_Nl41w?e=yOljjN" target="_blank">Security &amp; Compliance Center PowerShell commands</a>.</p>
<p>Here's a more complex example of using PowerShell. From the Security &amp; Compliance admin center, you can download an XML of the rules, update the XML, then upload the XML to modify the rules.</p>
<p>1. Run Connect-IPPSession to connect to the security and compliance PowerShell</p>
<p>2. Export the XML file of the current rules using the following:</p>
<p><code>$ruleCollections = Get-DlpSensitiveInformationTypeRulePackage</code></p>
<p><code>Set-Content -path C:\\custompath\\exportedRules.xml -Encoding Byte -Value $ruleCollections.SerializedClassificationRuleCollection</code></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">3. Modify the exported XML.</span></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">4. Upload your new rules</span></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;"><code>New-DlpSensitiveInformationTypeRulePackage -FileData (Get-Content -Path "C:\\custompath\\</code></span><span style="color: rgb(33,37,41);background-color: rgb(241,241,241);font-size: 16px;font-family: monospace;">exportedRules</span><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;"><code>.xml" -Encoding Byte)</code></span></p>
<p><span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">To confirm, type <strong>Y</strong>, and then press <strong>Enter</strong>.</span></p>
<h3>Connect to SharePoint Online using PowerShell</h3>
<p>Connecting to SharePoint Online using PowerShell takes a couple of extra steps. It isn't difficult, you just need to grab another piece of information.</p>
<p>1. Go to <a href="https://admin.microsoft.com/Adminportal/Home?source=applauncher#/alladmincenters" target="_blank">https://admin.microsoft.com/Adminportal/Home?source=applauncher#/alladmincenters</a> and login to your Office 365 tenant using the global admin credentials.</p>
<p>2. Click <strong>SharePoint</strong> in the list.</p>
<div style="text-align:none;"><img src="https://i.ibb.co/xMS0rB1/sharepoint-admin-center.png" alt="Open SharePoint admin center" style="height: auto;width: auto"/></div>
<p>3. Copy the SharePoint URL. Everything before the _layouts.</p>
<img src="https://i.ibb.co/BKbHN2x/Share-Point-url.png" alt="Copy the SharePoint URL" style="height: auto;width: auto"/>
<p>4. Run the following command <strong>Connect-SPOService -Url &lt;The URL you copied&gt;</strong> replacing the &lt;The URL you copied&gt; with the URL you copied in step 3.</p>
<img src="https://i.ibb.co/pPgzDsj/connect-to-sharepoint-online-using-powershell.png" alt="Connect the SharePoint Online using PowerShell" style="height: auto;width: auto"/>
<p>5. Login with your admin credentials.</p>
<p>That's it. You're now connected to SharePoint Online using PowerShell. To view the commands run <strong>Get-Command -Module Microsoft.Online.SharePoint.PowerShell</strong>.</p>
<p>Let's take another example command. Let's say you're tasked with securing your SharePoint environment. You need to stop users from <span style="color: rgb(33,37,41);background-color: rgb(255,255,255);font-size: 16px;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji;">downloading, printing, and syncing files</span> from SharePoint Online using unmanaged devices. What's a managed device? A managed device is a device that is hybrid Azure AD joined or compliant in Intune. In short, a user has logged in to your SharePoint environment using their device. How do you do it? You run <strong>Set-SPOTenant -ConditionalAccessPolicy AllowLimitedAccess</strong>. Let's break down the command. The Set-SPOTenant portion is the command. It's run to set properties on the SharePoint Online organization.</p>
<h3>Connect to Microsoft Teams using PowerShell</h3>
<p>Excellent, now we are connecting to Microsoft 365, Exchage Online, Azure AD, SharePoint Online, and Security &amp; Compliance center. But what about Microsoft Teams? It's just as easy.</p>
<p>1. From PowerShell run the following command: <strong>Connect-MicrosoftTeams</strong></p>
<p>2. Enter your username and password like you did when connecting to Microsoft 365.</p>
<p>That's it. You're now connected to Microsoft Teams using PowerShell. You can run <strong>Get-Command -Module MicrosoftTeams</strong> to get the commands for Microsoft Teams.</p>
<h3>To Disconnect from Microsoft 365 using PowerShell</h3>
<p>To disconnect from Microsoft 365 PowerShell simply close the PowerShell window. You can simply close the window to disconnect from all the PowerShell connections.</p>
<p>To disconnect from Exchange Online or Security and Compliance PowerShell run the following command: <strong>Disconnect-ExchangeOnline</strong></p>
<p>To disconnect from Azure AD PowerShell run the following command: <strong>Disconnect-AzureAD</strong></p>
<p>To disconnect from SharePoint Online PowerShell run the following command: <strong>Disconnect-SPOService</strong></p>
<p>To disconnect from Microsoft Teams PowerShell run the following command: <strong>Disconnect-MicrosoftTeams</strong></p>
`,
      nextContentSlug: 'How-to-create-users-in-Microsoft-365-Cloud-Only-uYCIPbnMC',
      previousContentSlug: 'Managing-the-Microsoft-365-tenant-Introduction-to-the-admin-centers-bzotoOjEe',
      hasCompletedContent: false,
      userAcct: {completedContent: []}
    }
  }

  componentDidMount() {
    this.onAuthStateChangedListener = onAuthStateChanged((user) => {
      if (user) {
        getDoc('courses/MS-500/users', user.uid).then((userAcct) => {
          if (!userAcct.completedContent) {
            userAcct.completedContent = []
          }
          this.setState({userAcct})
        })
      }
    })

    if (isBrowser()) {
      document.addEventListener('scroll', this.trackScrolling)
      this.setState({isTrackScrolling: true})
    }

    if (this.state.course.COURSE) {
      getDoc('courses', 'MS-500').then((course) => {
        this.setState({course})

        if (this.state.articles[0] === 'ARTICLES') {
          getAllDocs('courses/MS-500/contents').then((articles) => {
            const contentSorted = sort(course, articles)
            this.setState({ articles: contentSorted })

            if (this.state.article.ARTICLE) {
              getDoc('courses/MS-500/contents', '2QfoI2HxY').then((article) => {
                const articleHtml = draftToHtml(article.article)

                const idx = course.contentOrder.indexOf(article.id)

                const nextContentSlug = idx < articles.length - 1 ? contentSorted[idx + 1].slug : this.state.nextContentSlug
                const previousContentSlug = idx > 0 ? contentSorted[idx - 1].slug : this.state.previousContentSlug

                this.setState({article, articleHtml, nextContentSlug, previousContentSlug})
              })
            }
          })
        }
      })
    }
  }

  componentWillUnmount() {
    if (isBrowser() && this.state.isTrackScrolling)
      document.removeEventListener('scroll', this.trackScrolling);

    this.onAuthStateChangedListener()
  }

  trackScrolling() {
    if (document.body.scrollHeight * .8 < window.innerHeight + window.scrollY) {
      this.setHasCompletedContent(true)
    }
  }

  setHasCompletedContent(val) {
    if (val === true) {
      document.removeEventListener('scroll', this.trackScrolling);
      this.setState({isTrackScrolling: false})

      if (this.state.userAcct.id) {
        const userAcct = this.state.userAcct

        if (!userAcct.completedContent.includes(this.state.article.id)) {
          userAcct.completedContent.push(this.state.article.id)
          this.setState({userAcct})
          saveDoc('courses/MS-500/users', userAcct)
        }
      }
    }
  }

  render() {
    const jsonLd = {
      headline: this.state.article.title,
      datePublished: this.state.article.datePublished,
      keywords: [
        "Microsoft",
        "Microsoft 365",
        "Office 365",
        'MS-500',
        'Microsoft 365 Security Administration'
      ],
      "author": {
        "@type": "Person",
        "name": "John Gruber",
        url: 'https://medium.com/@gruberjl'
      }
    }

    return (
      <Page jsonLdType={'BlogPosting'} jsonLd={jsonLd} image={this.state.article.featuredImage} canonical={this.props.location.href} title={this.state.article.title} description={this.state.article.description}>
        <main>
          <Container fluid>
            <Row>
              <Col lg={9}>
                <Container>
                  <h1 style={marginTop24Style}>{this.state.article.title}</h1>
                  <div dangerouslySetInnerHTML={{__html: this.state.articleHtml}} className='img-width-100 article'></div>
                  <div className='flex-space-between margin12'>
                    <Link to={ this.state.previousContentSlug === 'PREVIOUS_CONTENT' ? '/' : `/course/ms-500/learn/${this.state.previousContentSlug}` }><IoChevronBack /> Previous</Link>
                    <Link to={ this.state.nextContentSlug === 'NEXT_CONTENT' ? '/' : `/course/ms-500/learn/${this.state.nextContentSlug}` }>Next <IoChevronForward /></Link>
                  </div>
                </Container>
              </Col>
              <Col lg={3}>
                <Accordion defaultActiveKey="0">
                  {this.state.course.sections.map((section, idx) => (
                    <Accordion.Item eventKey={idx} key={idx}>
                      <Accordion.Header>{section.title}</Accordion.Header>
                      <Accordion.Body style={removePaddingStyle}>
                        <ListGroup defaultActiveKey={`/course/ms-500/learn/${this.state.currentSlug}`} variant="flush">
                          { this.state.articles.filter(article => article.sectionId === section.id).map((article, articleIdx) => (
                            <ListGroup.Item style={listItemStyle} action to={`/course/ms-500/learn/${article.slug}`} href={`/course/ms-500/learn/${article.slug}`} as={Link} key={articleIdx} className='navigation-item'>
                              <Form.Check label={article.title} checked={this.state.userAcct.completedContent.includes(article.id)} onChange={() => {}} />
                            </ListGroup.Item>
                          ))}
                        </ListGroup>
                      </Accordion.Body>
                    </Accordion.Item>
                  ))}
                </Accordion>
              </Col>
            </Row>
          </Container>
        </main>
      </Page>
    )
  }
}

export default ArticlePage
